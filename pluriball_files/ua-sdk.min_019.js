/*! UA-Web-Push: a01e5f2:1740058291391 */!function(){"use strict";var t={946:function(t){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},33:function(t){function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}t.exports=function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}},424:function(t){t.exports=function(t){return t&&t.__esModule?t:{default:t}}},924:function(t){function e(n){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?t.exports=e=function(t){return typeof t}:t.exports=e=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(n)}t.exports=e},656:function(t,e,n){var r=n(424),i=r(n(946)),o=r(n(33));var a=function(){function t(){(0,i.default)(this,t),this._acquired=!1,this._waitingResolvers=[]}return(0,o.default)(t,[{key:"acquired",get:function(){return this._acquired}},{key:"acquireAsync",value:function(){var t=this;return this._acquired?new Promise((function(e){t._waitingResolvers.push(e)})):(this._acquired=!0,Promise.resolve())}},{key:"tryAcquire",value:function(){return!this._acquired&&(this._acquired=!0,!0)}},{key:"release",value:function(){if(!this._acquired)throw new Error("Cannot release an unacquired lock");this._waitingResolvers.length>0?this._waitingResolvers.shift()():this._acquired=!1}}]),t}();e.Z=a},314:function(t,e,n){var r,i,o;t=n.nmd(t);var a,s=n(424)(n(924));a=function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==(0,s.default)(t)&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=90)}({17:function(t,e,n){e.__esModule=!0,e.default=void 0;var r=n(18),i=function(){function t(){}return t.getFirstMatch=function(t,e){var n=e.match(t);return n&&n.length>0&&n[1]||""},t.getSecondMatch=function(t,e){var n=e.match(t);return n&&n.length>1&&n[2]||""},t.matchAndReturnConst=function(t,e,n){if(t.test(e))return n},t.getWindowsVersionName=function(t){switch(t){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},t.getMacOSVersionName=function(t){var e=t.split(".").splice(0,2).map((function(t){return parseInt(t,10)||0}));if(e.push(0),10===e[0])switch(e[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},t.getAndroidVersionName=function(t){var e=t.split(".").splice(0,2).map((function(t){return parseInt(t,10)||0}));if(e.push(0),!(1===e[0]&&e[1]<5))return 1===e[0]&&e[1]<6?"Cupcake":1===e[0]&&e[1]>=6?"Donut":2===e[0]&&e[1]<2?"Eclair":2===e[0]&&2===e[1]?"Froyo":2===e[0]&&e[1]>2?"Gingerbread":3===e[0]?"Honeycomb":4===e[0]&&e[1]<1?"Ice Cream Sandwich":4===e[0]&&e[1]<4?"Jelly Bean":4===e[0]&&e[1]>=4?"KitKat":5===e[0]?"Lollipop":6===e[0]?"Marshmallow":7===e[0]?"Nougat":8===e[0]?"Oreo":9===e[0]?"Pie":void 0},t.getVersionPrecision=function(t){return t.split(".").length},t.compareVersions=function(e,n,r){void 0===r&&(r=!1);var i=t.getVersionPrecision(e),o=t.getVersionPrecision(n),a=Math.max(i,o),s=0,u=t.map([e,n],(function(e){var n=a-t.getVersionPrecision(e),r=e+new Array(n+1).join(".0");return t.map(r.split("."),(function(t){return new Array(20-t.length).join("0")+t})).reverse()}));for(r&&(s=a-Math.min(i,o)),a-=1;a>=s;){if(u[0][a]>u[1][a])return 1;if(u[0][a]===u[1][a]){if(a===s)return 0;a-=1}else if(u[0][a]<u[1][a])return-1}},t.map=function(t,e){var n,r=[];if(Array.prototype.map)return Array.prototype.map.call(t,e);for(n=0;n<t.length;n+=1)r.push(e(t[n]));return r},t.find=function(t,e){var n,r;if(Array.prototype.find)return Array.prototype.find.call(t,e);for(n=0,r=t.length;n<r;n+=1){var i=t[n];if(e(i,n))return i}},t.assign=function(t){for(var e,n,r=t,i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];if(Object.assign)return Object.assign.apply(Object,[t].concat(o));var u=function(){var t=o[e];"object"==(0,s.default)(t)&&null!==t&&Object.keys(t).forEach((function(e){r[e]=t[e]}))};for(e=0,n=o.length;e<n;e+=1)u();return t},t.getBrowserAlias=function(t){return r.BROWSER_ALIASES_MAP[t]},t.getBrowserTypeByAlias=function(t){return r.BROWSER_MAP[t]||""},t}();e.default=i,t.exports=e.default},18:function(t,e,n){e.__esModule=!0,e.ENGINE_MAP=e.OS_MAP=e.PLATFORMS_MAP=e.BROWSER_MAP=e.BROWSER_ALIASES_MAP=void 0,e.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},e.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},e.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},e.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},e.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(t,e,n){e.__esModule=!0,e.default=void 0;var r,i=(r=n(91))&&r.__esModule?r:{default:r},o=n(18);function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var s=function(){function t(){}var e,n;return t.getParser=function(t,e){if(void 0===e&&(e=!1),"string"!=typeof t)throw new Error("UserAgent should be a string");return new i.default(t,e)},t.parse=function(t){return new i.default(t).getResult()},e=t,(n=[{key:"BROWSER_MAP",get:function(){return o.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return o.ENGINE_MAP}},{key:"OS_MAP",get:function(){return o.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return o.PLATFORMS_MAP}}])&&a(e,n),t}();e.default=s,t.exports=e.default},91:function(t,e,n){e.__esModule=!0,e.default=void 0;var r=c(n(92)),i=c(n(93)),o=c(n(94)),a=c(n(95)),u=c(n(17));function c(t){return t&&t.__esModule?t:{default:t}}var l=function(){function t(t,e){if(void 0===e&&(e=!1),null==t||""===t)throw new Error("UserAgent parameter can't be empty");this._ua=t,this.parsedResult={},!0!==e&&this.parse()}var e=t.prototype;return e.getUA=function(){return this._ua},e.test=function(t){return t.test(this._ua)},e.parseBrowser=function(){var t=this;this.parsedResult.browser={};var e=u.default.find(r.default,(function(e){if("function"==typeof e.test)return e.test(t);if(e.test instanceof Array)return e.test.some((function(e){return t.test(e)}));throw new Error("Browser's test function is not valid")}));return e&&(this.parsedResult.browser=e.describe(this.getUA())),this.parsedResult.browser},e.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},e.getBrowserName=function(t){return t?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},e.getBrowserVersion=function(){return this.getBrowser().version},e.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},e.parseOS=function(){var t=this;this.parsedResult.os={};var e=u.default.find(i.default,(function(e){if("function"==typeof e.test)return e.test(t);if(e.test instanceof Array)return e.test.some((function(e){return t.test(e)}));throw new Error("Browser's test function is not valid")}));return e&&(this.parsedResult.os=e.describe(this.getUA())),this.parsedResult.os},e.getOSName=function(t){var e=this.getOS().name;return t?String(e).toLowerCase()||"":e||""},e.getOSVersion=function(){return this.getOS().version},e.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},e.getPlatformType=function(t){void 0===t&&(t=!1);var e=this.getPlatform().type;return t?String(e).toLowerCase()||"":e||""},e.parsePlatform=function(){var t=this;this.parsedResult.platform={};var e=u.default.find(o.default,(function(e){if("function"==typeof e.test)return e.test(t);if(e.test instanceof Array)return e.test.some((function(e){return t.test(e)}));throw new Error("Browser's test function is not valid")}));return e&&(this.parsedResult.platform=e.describe(this.getUA())),this.parsedResult.platform},e.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},e.getEngineName=function(t){return t?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},e.parseEngine=function(){var t=this;this.parsedResult.engine={};var e=u.default.find(a.default,(function(e){if("function"==typeof e.test)return e.test(t);if(e.test instanceof Array)return e.test.some((function(e){return t.test(e)}));throw new Error("Browser's test function is not valid")}));return e&&(this.parsedResult.engine=e.describe(this.getUA())),this.parsedResult.engine},e.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},e.getResult=function(){return u.default.assign({},this.parsedResult)},e.satisfies=function(t){var e=this,n={},r=0,i={},o=0;if(Object.keys(t).forEach((function(e){var a=t[e];"string"==typeof a?(i[e]=a,o+=1):"object"==(0,s.default)(a)&&(n[e]=a,r+=1)})),r>0){var a=Object.keys(n),c=u.default.find(a,(function(t){return e.isOS(t)}));if(c){var l=this.satisfies(n[c]);if(void 0!==l)return l}var f=u.default.find(a,(function(t){return e.isPlatform(t)}));if(f){var p=this.satisfies(n[f]);if(void 0!==p)return p}}if(o>0){var d=Object.keys(i),h=u.default.find(d,(function(t){return e.isBrowser(t,!0)}));if(void 0!==h)return this.compareVersion(i[h])}},e.isBrowser=function(t,e){void 0===e&&(e=!1);var n=this.getBrowserName().toLowerCase(),r=t.toLowerCase(),i=u.default.getBrowserTypeByAlias(r);return e&&i&&(r=i.toLowerCase()),r===n},e.compareVersion=function(t){var e=[0],n=t,r=!1,i=this.getBrowserVersion();if("string"==typeof i)return">"===t[0]||"<"===t[0]?(n=t.substr(1),"="===t[1]?(r=!0,n=t.substr(2)):e=[],">"===t[0]?e.push(1):e.push(-1)):"="===t[0]?n=t.substr(1):"~"===t[0]&&(r=!0,n=t.substr(1)),e.indexOf(u.default.compareVersions(i,n,r))>-1},e.isOS=function(t){return this.getOSName(!0)===String(t).toLowerCase()},e.isPlatform=function(t){return this.getPlatformType(!0)===String(t).toLowerCase()},e.isEngine=function(t){return this.getEngineName(!0)===String(t).toLowerCase()},e.is=function(t){return this.isBrowser(t)||this.isOS(t)||this.isPlatform(t)},e.some=function(t){var e=this;return void 0===t&&(t=[]),t.some((function(t){return e.is(t)}))},t}();e.default=l,t.exports=e.default},92:function(t,e,n){e.__esModule=!0,e.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},o=/version\/(\d+(\.?_?\d+)+)/i,a=[{test:[/googlebot/i],describe:function(t){var e={name:"Googlebot"},n=i.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,t)||i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/opera/i],describe:function(t){var e={name:"Opera"},n=i.default.getFirstMatch(o,t)||i.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/opr\/|opios/i],describe:function(t){var e={name:"Opera"},n=i.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,t)||i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/SamsungBrowser/i],describe:function(t){var e={name:"Samsung Internet for Android"},n=i.default.getFirstMatch(o,t)||i.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/Whale/i],describe:function(t){var e={name:"NAVER Whale Browser"},n=i.default.getFirstMatch(o,t)||i.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/MZBrowser/i],describe:function(t){var e={name:"MZ Browser"},n=i.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,t)||i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/focus/i],describe:function(t){var e={name:"Focus"},n=i.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,t)||i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/swing/i],describe:function(t){var e={name:"Swing"},n=i.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,t)||i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/coast/i],describe:function(t){var e={name:"Opera Coast"},n=i.default.getFirstMatch(o,t)||i.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/yabrowser/i],describe:function(t){var e={name:"Yandex Browser"},n=i.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,t)||i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/ucbrowser/i],describe:function(t){var e={name:"UC Browser"},n=i.default.getFirstMatch(o,t)||i.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/Maxthon|mxios/i],describe:function(t){var e={name:"Maxthon"},n=i.default.getFirstMatch(o,t)||i.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/epiphany/i],describe:function(t){var e={name:"Epiphany"},n=i.default.getFirstMatch(o,t)||i.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/puffin/i],describe:function(t){var e={name:"Puffin"},n=i.default.getFirstMatch(o,t)||i.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/sleipnir/i],describe:function(t){var e={name:"Sleipnir"},n=i.default.getFirstMatch(o,t)||i.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/k-meleon/i],describe:function(t){var e={name:"K-Meleon"},n=i.default.getFirstMatch(o,t)||i.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/micromessenger/i],describe:function(t){var e={name:"WeChat"},n=i.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,t)||i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/qqbrowser/i],describe:function(t){var e={name:/qqbrowserlite/i.test(t)?"QQ Browser Lite":"QQ Browser"},n=i.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,t)||i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/msie|trident/i],describe:function(t){var e={name:"Internet Explorer"},n=i.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/\sedg\//i],describe:function(t){var e={name:"Microsoft Edge"},n=i.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/edg([ea]|ios)/i],describe:function(t){var e={name:"Microsoft Edge"},n=i.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/vivaldi/i],describe:function(t){var e={name:"Vivaldi"},n=i.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/seamonkey/i],describe:function(t){var e={name:"SeaMonkey"},n=i.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/sailfish/i],describe:function(t){var e={name:"Sailfish"},n=i.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,t);return n&&(e.version=n),e}},{test:[/silk/i],describe:function(t){var e={name:"Amazon Silk"},n=i.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/phantom/i],describe:function(t){var e={name:"PhantomJS"},n=i.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/slimerjs/i],describe:function(t){var e={name:"SlimerJS"},n=i.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(t){var e={name:"BlackBerry"},n=i.default.getFirstMatch(o,t)||i.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/(web|hpw)[o0]s/i],describe:function(t){var e={name:"WebOS Browser"},n=i.default.getFirstMatch(o,t)||i.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/bada/i],describe:function(t){var e={name:"Bada"},n=i.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/tizen/i],describe:function(t){var e={name:"Tizen"},n=i.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,t)||i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/qupzilla/i],describe:function(t){var e={name:"QupZilla"},n=i.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,t)||i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/firefox|iceweasel|fxios/i],describe:function(t){var e={name:"Firefox"},n=i.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/electron/i],describe:function(t){var e={name:"Electron"},n=i.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/chromium/i],describe:function(t){var e={name:"Chromium"},n=i.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,t)||i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/chrome|crios|crmo/i],describe:function(t){var e={name:"Chrome"},n=i.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/GSA/i],describe:function(t){var e={name:"Google Search"},n=i.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:function(t){var e=!t.test(/like android/i),n=t.test(/android/i);return e&&n},describe:function(t){var e={name:"Android Browser"},n=i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/playstation 4/i],describe:function(t){var e={name:"PlayStation 4"},n=i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/safari|applewebkit/i],describe:function(t){var e={name:"Safari"},n=i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/.*/i],describe:function(t){var e=-1!==t.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:i.default.getFirstMatch(e,t),version:i.default.getSecondMatch(e,t)}}}];e.default=a,t.exports=e.default},93:function(t,e,n){e.__esModule=!0,e.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},o=n(18),a=[{test:[/Roku\/DVP/],describe:function(t){var e=i.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,t);return{name:o.OS_MAP.Roku,version:e}}},{test:[/windows phone/i],describe:function(t){var e=i.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,t);return{name:o.OS_MAP.WindowsPhone,version:e}}},{test:[/windows /i],describe:function(t){var e=i.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,t),n=i.default.getWindowsVersionName(e);return{name:o.OS_MAP.Windows,version:e,versionName:n}}},{test:[/Macintosh(.*?) FxiOS(.*?) Version\//],describe:function(t){var e=i.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,t);return{name:o.OS_MAP.iOS,version:e}}},{test:[/macintosh/i],describe:function(t){var e=i.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,t).replace(/[_\s]/g,"."),n=i.default.getMacOSVersionName(e),r={name:o.OS_MAP.MacOS,version:e};return n&&(r.versionName=n),r}},{test:[/(ipod|iphone|ipad)/i],describe:function(t){var e=i.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,t).replace(/[_\s]/g,".");return{name:o.OS_MAP.iOS,version:e}}},{test:function(t){var e=!t.test(/like android/i),n=t.test(/android/i);return e&&n},describe:function(t){var e=i.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,t),n=i.default.getAndroidVersionName(e),r={name:o.OS_MAP.Android,version:e};return n&&(r.versionName=n),r}},{test:[/(web|hpw)[o0]s/i],describe:function(t){var e=i.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,t),n={name:o.OS_MAP.WebOS};return e&&e.length&&(n.version=e),n}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(t){var e=i.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,t)||i.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,t)||i.default.getFirstMatch(/\bbb(\d+)/i,t);return{name:o.OS_MAP.BlackBerry,version:e}}},{test:[/bada/i],describe:function(t){var e=i.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,t);return{name:o.OS_MAP.Bada,version:e}}},{test:[/tizen/i],describe:function(t){var e=i.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,t);return{name:o.OS_MAP.Tizen,version:e}}},{test:[/linux/i],describe:function(){return{name:o.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:o.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(t){var e=i.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,t);return{name:o.OS_MAP.PlayStation4,version:e}}}];e.default=a,t.exports=e.default},94:function(t,e,n){e.__esModule=!0,e.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},o=n(18),a=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(t){var e=i.default.getFirstMatch(/(can-l01)/i,t)&&"Nova",n={type:o.PLATFORMS_MAP.mobile,vendor:"Huawei"};return e&&(n.model=e),n}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?) Version\//],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet}}},{test:function(t){var e=t.test(/ipod|iphone/i),n=t.test(/like (ipod|iphone)/i);return e&&!n},describe:function(t){var e=i.default.getFirstMatch(/(ipod|iphone)/i,t);return{type:o.PLATFORMS_MAP.mobile,vendor:"Apple",model:e}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(t){return"blackberry"===t.getBrowserName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(t){return"bada"===t.getBrowserName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(t){return"windows phone"===t.getBrowserName()},describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(t){var e=Number(String(t.getOSVersion()).split(".")[0]);return"android"===t.getOSName(!0)&&e>=3},describe:function(){return{type:o.PLATFORMS_MAP.tablet}}},{test:function(t){return"android"===t.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(t){return"macos"===t.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(t){return"windows"===t.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop}}},{test:function(t){return"linux"===t.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop}}},{test:function(t){return"playstation 4"===t.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.tv}}},{test:function(t){return"roku"===t.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.tv}}}];e.default=a,t.exports=e.default},95:function(t,e,n){e.__esModule=!0,e.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},o=n(18),a=[{test:function(t){return"microsoft edge"===t.getBrowserName(!0)},describe:function(t){if(/\sedg\//i.test(t))return{name:o.ENGINE_MAP.Blink};var e=i.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,t);return{name:o.ENGINE_MAP.EdgeHTML,version:e}}},{test:[/trident/i],describe:function(t){var e={name:o.ENGINE_MAP.Trident},n=i.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:function(t){return t.test(/presto/i)},describe:function(t){var e={name:o.ENGINE_MAP.Presto},n=i.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:function(t){var e=t.test(/gecko/i),n=t.test(/like gecko/i);return e&&!n},describe:function(t){var e={name:o.ENGINE_MAP.Gecko},n=i.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:o.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(t){var e={name:o.ENGINE_MAP.WebKit},n=i.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}}];e.default=a,t.exports=e.default}})},"object"==(0,s.default)(e)&&"object"==(0,s.default)(t)?t.exports=a():(i=[],void 0===(o="function"==typeof(r=a)?r.apply(e,i):r)||(t.exports=o))},690:function(t){t.exports=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=void 0,i=void 0,o=void 0,a=[];return function(){var u=function(t){return"function"==typeof t?t():t}(e),c=(new Date).getTime(),l=!r||c-r>u;r=c;for(var f=arguments.length,p=Array(f),d=0;d<f;d++)p[d]=arguments[d];if(l&&n.leading)return n.accumulate?Promise.resolve(t.call(this,[p])).then((function(t){return t[0]})):Promise.resolve(t.call.apply(t,[this].concat(p)));if(i?clearTimeout(o):i=function(){var t={};return t.promise=new Promise((function(e,n){t.resolve=e,t.reject=n})),t}(),a.push(p),o=setTimeout(s.bind(this),u),n.accumulate){var h=a.length-1;return i.promise.then((function(t){return t[h]}))}return i.promise};function s(){var e=i;clearTimeout(o),Promise.resolve(n.accumulate?t.call(this,a):t.apply(this,a[a.length-1])).then(e.resolve,e.reject),a=[],i=null}}},397:function(t,e,n){var r=n(424)(n(924));Object.defineProperty(e,"__esModule",{value:!0});var i=new WeakMap,o=new WeakMap;function a(t){var e=i.get(t);return console.assert(null!=e,"'this' is expected an Event object, but got",t),e}function s(t){null==t.passiveListener?t.event.cancelable&&(t.canceled=!0,"function"==typeof t.event.preventDefault&&t.event.preventDefault()):"undefined"!=typeof console&&"function"==typeof console.error&&console.error("Unable to preventDefault inside passive event listener invocation.",t.passiveListener)}function u(t,e){i.set(this,{eventTarget:t,event:e,eventPhase:2,currentTarget:t,canceled:!1,stopped:!1,immediateStopped:!1,passiveListener:null,timeStamp:e.timeStamp||Date.now()}),Object.defineProperty(this,"isTrusted",{value:!1,enumerable:!0});for(var n=Object.keys(e),r=0;r<n.length;++r){var o=n[r];o in this||Object.defineProperty(this,o,c(o))}}function c(t){return{get:function(){return a(this).event[t]},set:function(e){a(this).event[t]=e},configurable:!0,enumerable:!0}}function l(t){return{value:function(){var e=a(this).event;return e[t].apply(e,arguments)},configurable:!0,enumerable:!0}}function f(t){if(null==t||t===Object.prototype)return u;var e=o.get(t);return null==e&&(e=function(t,e){var n=Object.keys(e);if(0===n.length)return t;function r(e,n){t.call(this,e,n)}r.prototype=Object.create(t.prototype,{constructor:{value:r,configurable:!0,writable:!0}});for(var i=0;i<n.length;++i){var o=n[i];if(!(o in t.prototype)){var a="function"==typeof Object.getOwnPropertyDescriptor(e,o).value;Object.defineProperty(r.prototype,o,a?l(o):c(o))}}return r}(f(Object.getPrototypeOf(t)),t),o.set(t,e)),e}function p(t){return a(t).immediateStopped}function d(t,e){a(t).passiveListener=e}u.prototype={get type(){return a(this).event.type},get target(){return a(this).eventTarget},get currentTarget(){return a(this).currentTarget},composedPath:function(){var t=a(this).currentTarget;return null==t?[]:[t]},get NONE(){return 0},get CAPTURING_PHASE(){return 1},get AT_TARGET(){return 2},get BUBBLING_PHASE(){return 3},get eventPhase(){return a(this).eventPhase},stopPropagation:function(){var t=a(this);t.stopped=!0,"function"==typeof t.event.stopPropagation&&t.event.stopPropagation()},stopImmediatePropagation:function(){var t=a(this);t.stopped=!0,t.immediateStopped=!0,"function"==typeof t.event.stopImmediatePropagation&&t.event.stopImmediatePropagation()},get bubbles(){return Boolean(a(this).event.bubbles)},get cancelable(){return Boolean(a(this).event.cancelable)},preventDefault:function(){s(a(this))},get defaultPrevented(){return a(this).canceled},get composed(){return Boolean(a(this).event.composed)},get timeStamp(){return a(this).timeStamp},get srcElement(){return a(this).eventTarget},get cancelBubble(){return a(this).stopped},set cancelBubble(t){if(t){var e=a(this);e.stopped=!0,"boolean"==typeof e.event.cancelBubble&&(e.event.cancelBubble=!0)}},get returnValue(){return!a(this).canceled},set returnValue(t){t||s(a(this))},initEvent:function(){}},Object.defineProperty(u.prototype,"constructor",{value:u,configurable:!0,writable:!0}),"undefined"!=typeof window&&void 0!==window.Event&&(Object.setPrototypeOf(u.prototype,window.Event.prototype),o.set(window.Event.prototype,u));var h=new WeakMap,v=3;function y(t){return null!==t&&"object"===(0,r.default)(t)}function b(t){var e=h.get(t);if(null==e)throw new TypeError("'this' is expected an EventTarget object, but got another value.");return e}function g(t,e){Object.defineProperty(t,"on".concat(e),function(t){return{get:function(){for(var e=b(this).get(t);null!=e;){if(e.listenerType===v)return e.listener;e=e.next}return null},set:function(e){"function"==typeof e||y(e)||(e=null);for(var n=b(this),r=null,i=n.get(t);null!=i;)i.listenerType===v?null!==r?r.next=i.next:null!==i.next?n.set(t,i.next):n.delete(t):r=i,i=i.next;if(null!==e){var o={listener:e,listenerType:v,passive:!1,once:!1,next:null};null===r?n.set(t,o):r.next=o}},configurable:!0,enumerable:!0}}(e))}function m(t){function e(){w.call(this)}e.prototype=Object.create(w.prototype,{constructor:{value:e,configurable:!0,writable:!0}});for(var n=0;n<t.length;++n)g(e.prototype,t[n]);return e}function w(){if(!(this instanceof w)){if(1===arguments.length&&Array.isArray(arguments[0]))return m(arguments[0]);if(arguments.length>0){for(var t=new Array(arguments.length),e=0;e<arguments.length;++e)t[e]=arguments[e];return m(t)}throw new TypeError("Cannot call a class as a function")}h.set(this,new Map)}w.prototype={addEventListener:function(t,e,n){if(null!=e){if("function"!=typeof e&&!y(e))throw new TypeError("'listener' should be a function or an object.");var r=b(this),i=y(n),o=(i?Boolean(n.capture):Boolean(n))?1:2,a={listener:e,listenerType:o,passive:i&&Boolean(n.passive),once:i&&Boolean(n.once),next:null},s=r.get(t);if(void 0!==s){for(var u=null;null!=s;){if(s.listener===e&&s.listenerType===o)return;u=s,s=s.next}u.next=a}else r.set(t,a)}},removeEventListener:function(t,e,n){if(null!=e)for(var r=b(this),i=(y(n)?Boolean(n.capture):Boolean(n))?1:2,o=null,a=r.get(t);null!=a;){if(a.listener===e&&a.listenerType===i)return void(null!==o?o.next=a.next:null!==a.next?r.set(t,a.next):r.delete(t));o=a,a=a.next}},dispatchEvent:function(t){if(null==t||"string"!=typeof t.type)throw new TypeError('"event.type" should be a string.');var e=b(this),n=t.type,r=e.get(n);if(null==r)return!0;for(var i=function(t,e){return new(f(Object.getPrototypeOf(e)))(t,e)}(this,t),o=null;null!=r;){if(r.once?null!==o?o.next=r.next:null!==r.next?e.set(n,r.next):e.delete(n):o=r,d(i,r.passive?r.listener:null),"function"==typeof r.listener)try{r.listener.call(this,i)}catch(t){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(t)}else r.listenerType!==v&&"function"==typeof r.listener.handleEvent&&r.listener.handleEvent(i);if(p(i))break;r=r.next}return d(i,null),function(t,e){a(t).eventPhase=e}(i,0),function(t,e){a(t).currentTarget=e}(i,null),!i.defaultPrevented}},Object.defineProperty(w.prototype,"constructor",{value:w,configurable:!0,writable:!0}),"undefined"!=typeof window&&void 0!==window.EventTarget&&Object.setPrototypeOf(w.prototype,window.EventTarget.prototype),e.defineEventAttribute=g,e.EventTarget=w,e.default=w,t.exports=w,t.exports.EventTarget=t.exports.default=w,t.exports.defineEventAttribute=g},953:function(t){t.exports=function(t){return"string"==typeof t&&e.test(t)&&!isNaN(Date.parse(t))};var e=new RegExp("^\\d{4}-\\d{2}-\\d{2}((T\\d{2}:\\d{2}(:\\d{2})?)(\\.\\d{1,6})?(Z|(\\+|-)\\d{2}:\\d{2})?)?$")},257:function(t,e,n){var r=n(424);Object.defineProperty(e,"v4",{enumerable:!0,get:function(){return a.default}});var i=r(n(144)),o=r(n(501)),a=r(n(651)),s=r(n(370)),u=r(n(923)),c=r(n(484)),l=r(n(721)),f=r(n(376)),p=r(n(216))},357:function(t,e){function n(t){return 14+(t+64>>>9<<4)+1}function r(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}function i(t,e,n,i,o,a){return r((s=r(r(e,t),r(i,a)))<<(u=o)|s>>>32-u,n);var s,u}function o(t,e,n,r,o,a,s){return i(e&n|~e&r,t,e,o,a,s)}function a(t,e,n,r,o,a,s){return i(e&r|n&~r,t,e,o,a,s)}function s(t,e,n,r,o,a,s){return i(e^n^r,t,e,o,a,s)}function u(t,e,n,r,o,a,s){return i(n^(e|~r),t,e,o,a,s)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var c=function(t){if("string"==typeof t){var e=unescape(encodeURIComponent(t));t=new Uint8Array(e.length);for(var i=0;i<e.length;++i)t[i]=e.charCodeAt(i)}return function(t){for(var e=[],n=32*t.length,r="0123456789abcdef",i=0;i<n;i+=8){var o=t[i>>5]>>>i%32&255,a=parseInt(r.charAt(o>>>4&15)+r.charAt(15&o),16);e.push(a)}return e}(function(t,e){t[e>>5]|=128<<e%32,t[n(e)-1]=e;for(var i=1732584193,c=-271733879,l=-1732584194,f=271733878,p=0;p<t.length;p+=16){var d=i,h=c,v=l,y=f;i=o(i,c,l,f,t[p],7,-680876936),f=o(f,i,c,l,t[p+1],12,-389564586),l=o(l,f,i,c,t[p+2],17,606105819),c=o(c,l,f,i,t[p+3],22,-1044525330),i=o(i,c,l,f,t[p+4],7,-176418897),f=o(f,i,c,l,t[p+5],12,1200080426),l=o(l,f,i,c,t[p+6],17,-1473231341),c=o(c,l,f,i,t[p+7],22,-45705983),i=o(i,c,l,f,t[p+8],7,1770035416),f=o(f,i,c,l,t[p+9],12,-1958414417),l=o(l,f,i,c,t[p+10],17,-42063),c=o(c,l,f,i,t[p+11],22,-1990404162),i=o(i,c,l,f,t[p+12],7,1804603682),f=o(f,i,c,l,t[p+13],12,-40341101),l=o(l,f,i,c,t[p+14],17,-1502002290),i=a(i,c=o(c,l,f,i,t[p+15],22,1236535329),l,f,t[p+1],5,-165796510),f=a(f,i,c,l,t[p+6],9,-1069501632),l=a(l,f,i,c,t[p+11],14,643717713),c=a(c,l,f,i,t[p],20,-373897302),i=a(i,c,l,f,t[p+5],5,-701558691),f=a(f,i,c,l,t[p+10],9,38016083),l=a(l,f,i,c,t[p+15],14,-660478335),c=a(c,l,f,i,t[p+4],20,-405537848),i=a(i,c,l,f,t[p+9],5,568446438),f=a(f,i,c,l,t[p+14],9,-1019803690),l=a(l,f,i,c,t[p+3],14,-187363961),c=a(c,l,f,i,t[p+8],20,1163531501),i=a(i,c,l,f,t[p+13],5,-1444681467),f=a(f,i,c,l,t[p+2],9,-51403784),l=a(l,f,i,c,t[p+7],14,1735328473),i=s(i,c=a(c,l,f,i,t[p+12],20,-1926607734),l,f,t[p+5],4,-378558),f=s(f,i,c,l,t[p+8],11,-2022574463),l=s(l,f,i,c,t[p+11],16,1839030562),c=s(c,l,f,i,t[p+14],23,-35309556),i=s(i,c,l,f,t[p+1],4,-1530992060),f=s(f,i,c,l,t[p+4],11,1272893353),l=s(l,f,i,c,t[p+7],16,-155497632),c=s(c,l,f,i,t[p+10],23,-1094730640),i=s(i,c,l,f,t[p+13],4,681279174),f=s(f,i,c,l,t[p],11,-358537222),l=s(l,f,i,c,t[p+3],16,-722521979),c=s(c,l,f,i,t[p+6],23,76029189),i=s(i,c,l,f,t[p+9],4,-640364487),f=s(f,i,c,l,t[p+12],11,-421815835),l=s(l,f,i,c,t[p+15],16,530742520),i=u(i,c=s(c,l,f,i,t[p+2],23,-995338651),l,f,t[p],6,-198630844),f=u(f,i,c,l,t[p+7],10,1126891415),l=u(l,f,i,c,t[p+14],15,-1416354905),c=u(c,l,f,i,t[p+5],21,-57434055),i=u(i,c,l,f,t[p+12],6,1700485571),f=u(f,i,c,l,t[p+3],10,-1894986606),l=u(l,f,i,c,t[p+10],15,-1051523),c=u(c,l,f,i,t[p+1],21,-2054922799),i=u(i,c,l,f,t[p+8],6,1873313359),f=u(f,i,c,l,t[p+15],10,-30611744),l=u(l,f,i,c,t[p+6],15,-1560198380),c=u(c,l,f,i,t[p+13],21,1309151649),i=u(i,c,l,f,t[p+4],6,-145523070),f=u(f,i,c,l,t[p+11],10,-1120210379),l=u(l,f,i,c,t[p+2],15,718787259),c=u(c,l,f,i,t[p+9],21,-343485551),i=r(i,d),c=r(c,h),l=r(l,v),f=r(f,y)}return[i,c,l,f]}(function(t){if(0===t.length)return[];for(var e=8*t.length,r=new Uint32Array(n(e)),i=0;i<e;i+=8)r[i>>5]|=(255&t[i/8])<<i%32;return r}(t),8*t.length))};e.default=c},923:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;e.default="00000000-0000-0000-0000-000000000000"},216:function(t,e,n){var r=n(424);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(721));var o=function(t){if(!(0,i.default)(t))throw TypeError("Invalid UUID");var e,n=new Uint8Array(16);return n[0]=(e=parseInt(t.slice(0,8),16))>>>24,n[1]=e>>>16&255,n[2]=e>>>8&255,n[3]=255&e,n[4]=(e=parseInt(t.slice(9,13),16))>>>8,n[5]=255&e,n[6]=(e=parseInt(t.slice(14,18),16))>>>8,n[7]=255&e,n[8]=(e=parseInt(t.slice(19,23),16))>>>8,n[9]=255&e,n[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,n[11]=e/4294967296&255,n[12]=e>>>24&255,n[13]=e>>>16&255,n[14]=e>>>8&255,n[15]=255&e,n};e.default=o},729:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;e.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},794:function(t,e){var n;Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){if(!n&&!(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(r)};var r=new Uint8Array(16)},637:function(t,e){function n(t,e,n,r){switch(t){case 0:return e&n^~e&r;case 1:case 3:return e^n^r;case 2:return e&n^e&r^n&r}}function r(t,e){return t<<e|t>>>32-e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=function(t){var e=[1518500249,1859775393,2400959708,3395469782],i=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof t){var o=unescape(encodeURIComponent(t));t=[];for(var a=0;a<o.length;++a)t.push(o.charCodeAt(a))}else Array.isArray(t)||(t=Array.prototype.slice.call(t));t.push(128);for(var s=t.length/4+2,u=Math.ceil(s/16),c=new Array(u),l=0;l<u;++l){for(var f=new Uint32Array(16),p=0;p<16;++p)f[p]=t[64*l+4*p]<<24|t[64*l+4*p+1]<<16|t[64*l+4*p+2]<<8|t[64*l+4*p+3];c[l]=f}c[u-1][14]=8*(t.length-1)/Math.pow(2,32),c[u-1][14]=Math.floor(c[u-1][14]),c[u-1][15]=8*(t.length-1)&4294967295;for(var d=0;d<u;++d){for(var h=new Uint32Array(80),v=0;v<16;++v)h[v]=c[d][v];for(var y=16;y<80;++y)h[y]=r(h[y-3]^h[y-8]^h[y-14]^h[y-16],1);for(var b=i[0],g=i[1],m=i[2],w=i[3],_=i[4],S=0;S<80;++S){var P=Math.floor(S/20),x=r(b,5)+n(P,g,m,w)+_+e[P]+h[S]>>>0;_=w,w=m,m=r(g,30)>>>0,g=b,b=x}i[0]=i[0]+b>>>0,i[1]=i[1]+g>>>0,i[2]=i[2]+m>>>0,i[3]=i[3]+w>>>0,i[4]=i[4]+_>>>0}return[i[0]>>24&255,i[0]>>16&255,i[0]>>8&255,255&i[0],i[1]>>24&255,i[1]>>16&255,i[1]>>8&255,255&i[1],i[2]>>24&255,i[2]>>16&255,i[2]>>8&255,255&i[2],i[3]>>24&255,i[3]>>16&255,i[3]>>8&255,255&i[3],i[4]>>24&255,i[4]>>16&255,i[4]>>8&255,255&i[4]]};e.default=i},376:function(t,e,n){var r=n(424);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;for(var i=r(n(721)),o=[],a=0;a<256;++a)o.push((a+256).toString(16).substr(1));var s=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(o[t[e+0]]+o[t[e+1]]+o[t[e+2]]+o[t[e+3]]+"-"+o[t[e+4]]+o[t[e+5]]+"-"+o[t[e+6]]+o[t[e+7]]+"-"+o[t[e+8]]+o[t[e+9]]+"-"+o[t[e+10]]+o[t[e+11]]+o[t[e+12]]+o[t[e+13]]+o[t[e+14]]+o[t[e+15]]).toLowerCase();if(!(0,i.default)(n))throw TypeError("Stringified UUID is invalid");return n};e.default=s},144:function(t,e,n){var r=n(424);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i,o,a=r(n(794)),s=r(n(376)),u=0,c=0;var l=function(t,e,n){var r=e&&n||0,l=e||new Array(16),f=(t=t||{}).node||i,p=void 0!==t.clockseq?t.clockseq:o;if(null==f||null==p){var d=t.random||(t.rng||a.default)();null==f&&(f=i=[1|d[0],d[1],d[2],d[3],d[4],d[5]]),null==p&&(p=o=16383&(d[6]<<8|d[7]))}var h=void 0!==t.msecs?t.msecs:Date.now(),v=void 0!==t.nsecs?t.nsecs:c+1,y=h-u+(v-c)/1e4;if(y<0&&void 0===t.clockseq&&(p=p+1&16383),(y<0||h>u)&&void 0===t.nsecs&&(v=0),v>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");u=h,c=v,o=p;var b=(1e4*(268435455&(h+=122192928e5))+v)%4294967296;l[r++]=b>>>24&255,l[r++]=b>>>16&255,l[r++]=b>>>8&255,l[r++]=255&b;var g=h/4294967296*1e4&268435455;l[r++]=g>>>8&255,l[r++]=255&g,l[r++]=g>>>24&15|16,l[r++]=g>>>16&255,l[r++]=p>>>8|128,l[r++]=255&p;for(var m=0;m<6;++m)l[r+m]=f[m];return e||(0,s.default)(l)};e.default=l},501:function(t,e,n){var r=n(424);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(855)),o=r(n(357)),a=(0,i.default)("v3",48,o.default);e.default=a},855:function(t,e,n){var r=n(424);Object.defineProperty(e,"__esModule",{value:!0}),e.URL=e.DNS=void 0,e.default=function(t,e,n){function r(t,r,a,s){if("string"==typeof t&&(t=function(t){t=unescape(encodeURIComponent(t));for(var e=[],n=0;n<t.length;++n)e.push(t.charCodeAt(n));return e}(t)),"string"==typeof r&&(r=(0,o.default)(r)),16!==r.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var u=new Uint8Array(16+t.length);if(u.set(r),u.set(t,r.length),(u=n(u))[6]=15&u[6]|e,u[8]=63&u[8]|128,a){s=s||0;for(var c=0;c<16;++c)a[s+c]=u[c];return a}return(0,i.default)(u)}try{r.name=t}catch(t){}return r.DNS=a,r.URL=s,r};var i=r(n(376)),o=r(n(216));var a="6ba7b810-9dad-11d1-80b4-00c04fd430c8";e.DNS=a;var s="6ba7b811-9dad-11d1-80b4-00c04fd430c8";e.URL=s},651:function(t,e,n){var r=n(424);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(794)),o=r(n(376));var a=function(t,e,n){var r=(t=t||{}).random||(t.rng||i.default)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,e){n=n||0;for(var a=0;a<16;++a)e[n+a]=r[a];return e}return(0,o.default)(r)};e.default=a},370:function(t,e,n){var r=n(424);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(855)),o=r(n(637)),a=(0,i.default)("v5",80,o.default);e.default=a},721:function(t,e,n){var r=n(424);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(729));var o=function(t){return"string"==typeof t&&i.default.test(t)};e.default=o},484:function(t,e,n){var r=n(424);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(721));var o=function(t){if(!(0,i.default)(t))throw TypeError("Invalid UUID");return parseInt(t.substr(14,1),16)};e.default=o}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={id:r,loaded:!1,exports:{}};return t[r](o,o.exports,n),o.loaded=!0,o.exports}n.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t},function(){var t=n(656),e=n(397),r="https://aswpapieu.com",i="0.0.0",o={VERSION:"1.23.3",appVersion:i,configured:!1,workerUrl:"/push-worker.js",apiUrl:r,storagePrefix:"_ua_sdk",deprecatedStoragePrefix:null,disableAnalytics:!1,appKey:null,secret:null,token:null,defaultIcon:"",defaultTitle:"",defaultActionURL:"",vapidPublicKey:null,debug:!1,websitePushId:null,registrationDomain:null,mixedRegistrationDomains:!1,secureHost:"",secureBridgePath:null,secureBridgeUrl:null,dataCollectionOptInEnabled:!1,secureIframeUrl:null,skipWaiting:!0,allowedDomains:null,loadIfPushNotSupported:!1,trackEventsForOptOutChannels:!1,safariServiceUrl:r+"/api/safari/web-service/",paths:{cla:"/api/channels",cra:"/api/web-channels",tags:"/api/web-channels/tags",attributes:"/api/channels/attributes",custom_events:"/api/web-events/custom",remote_data:{app:"/api/remote-data/app"},subscription_lists:{list:"/api/subscription_lists/channels",update:"/api/channels/subscription_lists"},named_user:{associate:"/api/named_users/associate",disassociate:"/api/named_users/disassociate",tags:"/api/named_users/tags"},contact:{identify:"/api/contacts/identify",resolve:"/api/contacts/resolve",reset:"/api/contacts/reset",batch:"/api/contacts",subscription_lists_list:"/api/subscription_lists/contacts",registration:{email:"/api/channels/restricted/email",sms:"/api/channels/restricted/sms",open:"/api/channels/restricted/open"}},reports:{direct:"/api/web-events/direct",session:"/api/web-events/session",customEvent:"/api/web-events/custom"}},consts:{DISABLE_ANALYTICS:"disable_analytics"},contacts:{sessionLengthMs:36e5,namedUserTtlMs:2592e6,_forceExpireNamedUsers:!1},subscriptionLists:{cacheTtlMs:3e5},remoteData:{cacheTtlMs:6e5}},a=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},s=function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t};function u(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(o.debug){if(1===t.length&&(Array.isArray(t[0])||"object"==typeof t[0])&&console.table)return console.table(t[0]);console.log.apply(console,s([],a(t)))}}var c,l=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},f=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};try{c=window}catch(t){c=self}function p(t,e,n,r,i){var o;function a(){return o||(o=new Promise((function(r,o){var a=c.indexedDB.open(t(),i);a.addEventListener("upgradeneeded",(function(t){var r=t.target.result;try{r.createObjectStore(e,n)}catch(t){u('Error when "upgrading" indexedDB',t)}})),a.addEventListener("success",(function(){return r(a.result)})),a.addEventListener("error",(function(t){return o(t)}))})),o)}function s(t,n){void 0===n&&(n=!1);var r=n?"readwrite":"readonly";return t.transaction([e],r).objectStore(e)}function p(t,e,n){return void 0===e&&(e=function(t){return t.target.result}),void 0===n&&(n=function(t){return t.target.error}),new Promise((function(r,i){t.addEventListener("success",(function(t){r(e(t))})),t.addEventListener("error",(function(t){return i(n(t))}))}))}function d(){return a().then((function(t){return p(s(t).getAll())}))}return{getDB:a,getObjectStore:s,requestToPromise:p,get:function(t){return a().then((function(e){return p(s(e).get(t),(function(t){if(void 0!==t.target.result)return r(t)}))}))},getAll:d,set:function(t,e){return a().then((function(r){return n.keyPath?p(s(r,!0).put({type:t,value:e})):p(s(r,!0).put(e,t))}))},count:function(){return u("Db.count(): counting db %s",t()),a().then((function(t){return p(s(t).count())}))},remove:function(t){return a().then((function(e){return p(s(e,!0).delete(t))}))},copy:function(t){return l(this,void 0,void 0,(function(){var e,n;return f(this,(function(r){switch(r.label){case 0:return[4,t.count()];case 1:return r.sent()?[2,!1]:[4,d()];case 2:return(null==(e=r.sent())?void 0:e.length)?(u("Db.copy(): coppying db"),n=e.map((function(e){return t.set(e.type,e.value)})),[4,Promise.all(n)]):[3,4];case 3:return r.sent(),[2,!0];case 4:return[2,!1]}}))}))}}}var d=p((function(){return o.storagePrefix+":db"}),"blob",{keyPath:"type"},(function(t){var e;return null===(e=t.target.result)||void 0===e?void 0:e.value}),1),h=function(){return h=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},h.apply(this,arguments)},v=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},y=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},b=function(){function t(t){this._country=null,this._language=null,this._channel=null,(null==t?void 0:t.country)&&this.setCountry(null==t?void 0:t.country),(null==t?void 0:t.language)&&this.setLanguage(null==t?void 0:t.language)}return Object.defineProperty(t.prototype,"country",{get:function(){return this._country},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"language",{get:function(){return this._language},enumerable:!1,configurable:!0}),t.getStoredLocale=function(){return v(this,void 0,void 0,(function(){var t;return y(this,(function(e){switch(e.label){case 0:return[4,d.get("localeOverride")];case 1:return[2,{country:(null==(t=e.sent())?void 0:t.locale_country)||null,language:(null==t?void 0:t.locale_language)||null}]}}))}))},t.fromStorage=function(){return v(this,void 0,void 0,(function(){return y(this,(function(e){switch(e.label){case 0:return[4,t.getStoredLocale()];case 1:return[2,new t(e.sent())]}}))}))},t.prototype.setCountry=function(t){return"string"==typeof t&&2!==t.trim().length?Promise.reject("setCountry(): country should be two characters long"):(this._country="string"==typeof t?t.trim().toUpperCase():null,this._store())},t.prototype.setLanguage=function(t){return"string"==typeof t&&2!==t.trim().length?Promise.reject("setLanguage(): language should be two characters long"):(this._language="string"==typeof t?t.trim().toLowerCase():null,this._store())},t.prototype.set=function(t){var e=[];return void 0!==t.country&&e.push(this.setCountry(t.country)),void 0!==t.language&&e.push(this.setLanguage(t.language)),Promise.all(e).then((function(){}))},t.prototype.setChannel=function(t){this._channel=t,this._channel._setLocaleOverride(this)},t.prototype.clear=function(){var t=this;return this._language=null,this._country=null,d.remove("localeOverride").then((function(){var e;return null===(e=t._channel)||void 0===e?void 0:e._store(!1)})).then((function(){}))},t.prototype.toJSON=function(){return h(h({},this.country?{locale_country:this.country}:{}),this.language?{locale_language:this.language}:{})},t.prototype._store=function(){var t,e;return v(this,void 0,void 0,(function(){return y(this,(function(n){switch(n.label){case 0:return[4,d.set("localeOverride",this.toJSON())];case 1:return n.sent(),[4,null===(t=this._channel)||void 0===t?void 0:t._store(!1)];case 2:return n.sent(),[4,null===(e=this._channel)||void 0===e?void 0:e.update()];case 3:return n.sent(),[2]}}))}))},t}(),g=n(314),m=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};function w(t){var e=Intl.DateTimeFormat().resolvedOptions(),n=e.timeZone,r=m(e.locale.split("-"),2),i=r[0],o=r[1],a=(null==t?void 0:t.language)||i,s=(null==t?void 0:t.country)||o;!s&&navigator.languages&&(s=navigator.languages.reduce((function(t,e){return t||(t=e.includes("-")?e.split("-")[1]:null),t}),null)||"");return{localeCountry:s,localeLanguage:a,timezone:n}}var _=function(){return _=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},_.apply(this,arguments)},S=["chrome","edge","firefox","opera","safari","yandex browser"];function P(t){var e=t.optedIn,n=t.localeOverride,r=g.parse(navigator.userAgent),a=r.browser,s=r.platform,u={};try{var c=w(n),l=c.localeCountry,f=c.localeLanguage;u={timezone:c.timezone,locale_country:l,locale_language:f}}catch(t){}var p=navigator.userAgent,d=function(t){if(!t)return"unknown";if(t=t.toLowerCase(),!S.includes(t))return"unknown";return t.split(" ")[0]}(a.name),h=d+"-"+a.version,v="mobile"===s.type||"tablet"===s.type?"mobile":"desktop",y=o.VERSION,b=o.appVersion!==i?o.appVersion:void 0;return _(_({},u),{device_type:"web",opt_in:e,app_version:b,web:{user_agent_string:p,browser_name:d,browser_version:h,browser_type:v,web_sdk_version:y}})}var x=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},E=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},O="dataCollectionEnabled";function M(){return x(this,void 0,void 0,(function(){var t,e;return E(this,(function(n){switch(n.label){case 0:return t=o.dataCollectionOptInEnabled,[4,d.get(O)];case 1:return void 0!==(e=n.sent())?[2,e]:[4,d.set(O,!t)];case 2:return n.sent(),[2,!t]}}))}))}function k(t,e){var n,r,i,o,a,s;return x(this,void 0,void 0,(function(){return E(this,(function(u){switch(u.label){case 0:return t?[3,3]:(null===(r=null===(n=e.channel)||void 0===n?void 0:n.tags)||void 0===r||r.clear(),[4,null===(o=null===(i=e.channel)||void 0===i?void 0:i.namedUser)||void 0===o?void 0:o.remove()]);case 1:return u.sent(),[4,null===(a=e.channel)||void 0===a?void 0:a.optOut()];case 2:return u.sent(),[3,6];case 3:return[4,e.getNotificationPermission()];case 4:return"granted"!==u.sent()?[3,6]:[4,null===(s=e.channel)||void 0===s?void 0:s.set({opt_in:!0})];case 5:u.sent(),u.label=6;case 6:return[4,d.set(O,t)];case 7:return u.sent(),[2]}}))}))}var A=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},T=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},C=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},I=function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t},j=Object(),N=Object(),R=function(){function t(t,e){var n=t.ttlMs,r=t.prefix,i=t._getNow;this._ttlMs=n,this._prefix=r,this._getNow=null!=i?i:function(){return Date.now()},this._storage=e}return t.prototype._getExpiry=function(t){var e;return void 0!==t.expires?t.expires:(null!==(e=t.cachedAt)&&void 0!==e?e:0)+this._ttlMs},t.prototype._getCachedAt=function(t){var e;return void 0!==t.cachedAt?t.cachedAt:Math.max(0,(null!==(e=t.expires)&&void 0!==e?e:0)-this._ttlMs)},t.prototype._getValue=function(t){var e,n=this._storage.getItem(t);if(!n)return j;try{e=JSON.parse(n)}catch(e){return this._storage.removeItem(t),j}return e},t.prototype._getExpired=function(t){return this._getNow()>this._getExpiry(t)},t.prototype.info=function(t){var e=this._makeKey(t),n=this._getValue(e);return n===j?{cachedAt:0,exists:!1,expired:!0}:{cachedAt:this._getCachedAt(n),exists:!0,expired:this._getExpired(n)}},t.prototype.load=function(t,e){var n=this._makeKey(t),r=this._getValue(n);return r===j?j:this._getExpired(r)?(this._storage.removeItem(n),e?r.data:j):r.data},t.prototype.store=function(t,e){var n={cachedAt:this._getNow(),data:e};this._storage.setItem(this._makeKey(t),JSON.stringify(n))},t.prototype.invalidate=function(t){this._storage.removeItem(this._makeKey(t))},t.prototype._makeKey=function(t){return this._prefix+":"+t},t}(),B=function(){function t(t){this._storageManager=t}return t.prototype.get=function(t,e){return A(this,void 0,void 0,(function(){var n,r,i;return T(this,(function(o){switch(o.label){case 0:return n=this._storageManager.info(t),(r=this._storageManager.load(t,!0))===j||n.expired?[4,e(n.exists?n.cachedAt:void 0)]:[2,r];case 1:if((i=o.sent())===N){if(!n.exists||r===j)throw new Error("unable to cache a missed value");return this._storageManager.store(t,r),[2,r]}return this._storageManager.store(t,i),[2,i]}}))}))},t.prototype.invalidate=function(t){this._storageManager.invalidate(t)},t}(),L=function(){function t(t,e){var n=t.keyFn,r=t.indexKey;this._storageManager=e,this._indexKey=r,this._keyFn=n}return t.prototype.values=function(){var t=this,e=[],n=this._storageManager.load(this._indexKey);return n===j?[]:(n.forEach((function(r){var i=t._storageManager.load(r);i===j?t._storageManager.store(t._indexKey,n.filter((function(t){return t!==r}))):e.push(i)})),e)},t.prototype.push=function(t){var e=this._keyFn(t);this._pushToIndex(e),this._storageManager.store(e,t)},t.prototype._pushToIndex=function(t){var e=this._storageManager.load(this._indexKey);if(e!==j){var n=e.filter((function(e){return e!==t}));this._storageManager.store(this._indexKey,I(I([],C(n)),[t]))}else this._storageManager.store(this._indexKey,[t])},t}();function U(t,e){t=""+o.apiUrl+t;var n={Accept:"application/vnd.urbanairship+json; version=3;"};if(o.appKey&&o.token)n["X-UA-Appkey"]=o.appKey,n.Authorization="Bearer "+o.token;else if(o.appKey&&o.secret){var r=self.btoa(o.appKey+":"+o.secret);n.Authorization="Basic "+r}return e.credentials="include",e.body&&(n["Content-type"]="application/json","string"!=typeof e.body&&(e.body=JSON.stringify(e.body))),e.headers=e.headers||{},Object.assign(e.headers,n),u("REQUEST",t,e),self.fetch(t,e)}function D(t){return void 0===t||Array.isArray(t)?t:[t]}var F,q=(F=function(t,e){return F=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},F(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}F(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),G=function(t){function e(n){void 0===n&&(n="Predicate was not satisfied.");var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(r,e),r.name=r.constructor.name,r}return q(e,t),e}(TypeError),V=function(t){function e(n,r){void 0===r&&(r="Request Error");var i=t.call(this,r)||this;return i._statusCode=n,Object.setPrototypeOf(i,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,e),i.name=i.constructor.name,i}return q(e,t),Object.defineProperty(e.prototype,"statusCode",{get:function(){return this._statusCode},enumerable:!1,configurable:!0}),e}(Error),K=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},W=function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t},J=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return self.fetch.apply(self,W([],K(t)))},z=function(){return z=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},z.apply(this,arguments)},H=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Q=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Z=function(){function t(t){this._config=t}return t.prototype.get=function(t,e){return this._jsonRequestResponse("GET",t,e)},t.prototype.put=function(t,e,n){return this._jsonRequestResponse("PUT",t,n,e)},t.prototype.post=function(t,e,n){return this._jsonRequestResponse("POST",t,n,e)},t.prototype.patch=function(t,e,n){return this._jsonRequestResponse("PATCH",t,n,e)},t.prototype.delete=function(t,e){return H(this,void 0,void 0,(function(){return Q(this,(function(n){switch(n.label){case 0:return[4,this._requestResponse("DELETE",t,null!=e?e:{})];case 1:return n.sent(),[2]}}))}))},t.prototype._authHeaders=function(){switch(this._config.type){case"basic":return{Authorization:"Basic "+self.btoa(this._config.appKey+":"+this._config.secret)};case"bearer":return{"X-UA-Appkey":this._config.appKey,Authorization:"Bearer "+this._config.token};default:var t=this._config;throw new Error("invalid config: "+t)}},t.prototype._requestResponse=function(e,n,r){var i=r.headers,o=r.queryParams,a=void 0===o?{}:o,s=r.body,u=r.cache;return H(this,void 0,void 0,(function(){var r,o,c,l,f;return Q(this,(function(p){switch(p.label){case 0:return r=new URL(""+this._config.apiBase+n),o={method:e,cache:u},c=z({Accept:t.V3_ACCEPT_HEADER},this._authHeaders()),l=new URLSearchParams(r.search.slice(1)),Object.keys(a).forEach((function(t){var e;(e=a[t],Array.isArray(e)?e:[e]).forEach((function(e){l.append(t,e.toString())}))})),r.search=l.toString(),o.credentials="include",s&&(c["Content-Type"]="application/json",o.body="string"==typeof s?s:JSON.stringify(s)),o.headers=z(z({},c),null!=i?i:{}),[4,J(r.toString(),o)];case 1:if(!(f=p.sent()).ok)throw new V(f.status,f.statusText);return[2,f]}}))}))},t.prototype._jsonRequestResponse=function(t,e,n,r){var i=void 0===n?{}:n,o=i.headers,a=i.queryParams,s=i.predicate,u=i.cache;return H(this,void 0,void 0,(function(){var n;return Q(this,(function(i){switch(i.label){case 0:return[4,this._requestResponse(t,e,{headers:o,queryParams:a,body:r,cache:u})];case 1:return[4,i.sent().json()];case 2:if(n=i.sent(),s&&!s(n))throw new G;return[2,n]}}))}))},t.V3_ACCEPT_HEADER="application/vnd.urbanairship+json; version=3;",t}(),Y=Z;function X(t){if(t.appKey&&t.token)return new Y({apiBase:t.apiUrl,appKey:t.appKey,type:"bearer",token:t.token});if(t.appKey&&t.secret)return new Y({apiBase:t.apiUrl,appKey:t.appKey,type:"basic",secret:t.secret});throw new Error("invalid auth configuration: appKey and at least one of token or secret must be configured.")}var $=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},tt=["tags","channel"],et={set:function(t,e){var n;return null===(n=self.localStorage)||void 0===n?void 0:n.setItem(nt(t),e)},get:function(t){var e;return null===(e=self.localStorage)||void 0===e?void 0:e.getItem(nt(t))},setJSON:function(t,e){return this.set(t,JSON.stringify(e))},getJSON:function(t){var e=this.get(t);if(e)return JSON.parse(e)},clear:function(){var t;null===(t=self.localStorage)||void 0===t||t.clear()},remove:function(t){var e;return null===(e=self.localStorage)||void 0===e?void 0:e.removeItem(nt(t))},onStorage:function(t){return function(e){var n,r;try{for(var i=$(tt),a=i.next();!a.done;a=i.next()){var s=a.value,u=o.storagePrefix+":"+s;if(e.key===u){var c={};c[s]=JSON.parse(e.newValue||""),t(c)}}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}}};function nt(t){return o.storagePrefix+":"+t}function rt(t){return(null!=t?t:new Date).toISOString().split(".")[0]}var it,ot,at=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),st=function(t){function e(n){void 0===n&&(n="The provided name is not valid.");var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(r,e),r.name=r.constructor.name,r}return at(e,t),e}(Error);function ut(t){if("string"==typeof t)return t;if("number"==typeof t)return t.toString(10);if(t instanceof Date)return rt(t);throw new st("invalid attribute value")}!function(t){t.SET="set",t.REMOVE="remove"}(it||(it={})),function(t){t.ADD="add",t.SET="set",t.REMOVE="remove"}(ot||(ot={}));var ct=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},lt=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},ft=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},pt=function(){function t(t){this._getAudience=t}return t.prototype.set=function(t){return ct(this,void 0,void 0,(function(){return lt(this,(function(e){switch(e.label){case 0:return[4,M()];case 1:return e.sent()?[2,this.send(this.buildSetPayload(t))]:(console.warn("Data collection is disabled. Setting attributes is not allowed."),[2,!1])}}))}))},t.prototype.remove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.send(this.buildRemovePayload(t))},t.prototype.send=function(t,e){var n=void 0===e?{path:o.paths.attributes,method:"post"}:e,r=n.path,i=n.method;return ct(this,void 0,void 0,(function(){var e;return lt(this,(function(n){switch(n.label){case 0:if(t.attributes.length<1)return[2,Promise.resolve(!1)];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,U(r,{method:i,body:t})];case 2:return[2,n.sent().ok||Promise.reject(!1)];case 3:return e=n.sent(),[2,Promise.reject(e)];case 4:return[2]}}))}))},t.prototype.buildSetPayload=function(t){var e=ft((new Date).toISOString().split("."),1)[0],n=Object.entries(t).map((function(t){var n=ft(t,2);return{key:n[0],value:ut(n[1]),action:it.SET,timestamp:e}}));return{audience:this._getAudience(),attributes:n}},t.prototype.buildRemovePayload=function(t){var e=ft((new Date).toISOString().split("."),1)[0],n=t.map((function(t){return{key:t,action:it.REMOVE,timestamp:e}}));return{audience:this._getAudience(),attributes:n}},t}(),dt=pt,ht=n(690),vt=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),yt=function(t){function e(n){void 0===n&&(n="Cannot perform this operation without an associated channel.");var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(r,e),r.name=r.constructor.name,r}return vt(e,t),e}(Error),bt=function(t){function e(n){void 0===n&&(n="The provided name is not valid.");var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(r,e),r.name=r.constructor.name,r}return vt(e,t),e}(Error),gt=function(t){function e(n){void 0===n&&(n="Invalid tag group.");var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(r,e),r.name=r.constructor.name,r}return vt(e,t),e}(Error),mt=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},wt=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},_t=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},St=function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t};function Pt(t){var e=[];return St([],_t(t)).reverse().filter((function(t){return!e.includes(t.key)&&(e.push(t.key),!0)})).map(Et).reverse()}function xt(t){var e={},n={},r={};return t.forEach((function(t){switch(t.action){case"add":return e[t.group]||(e[t.group]=new Set),void t.tags.forEach((function(r){e[t.group].add(r),n[t.group]&&n[t.group].delete(r)}));case"remove":return n[t.group]||(n[t.group]=new Set),void t.tags.forEach((function(r){n[t.group].add(r),e[t.group]&&e[t.group].delete(r)}));case"set":return r[t.group]||(r[t.group]=new Set),delete e[t.group],delete n[t.group],void t.tags.forEach((function(e){return r[t.group].add(e)}));default:throw new Error("invalid tag mutation action: "+t)}})),{add:Ot(e),remove:Ot(n),set:Ot(r)}}function Et(t){switch(t.action){case"set":return{action:it.SET,key:t.key,value:ut(t.value),timestamp:t.timestamp};case"remove":return{action:it.REMOVE,key:t.key,timestamp:t.timestamp};default:throw new Error("invalid attribute mutation action: "+t)}}function Ot(t){var e={};return Object.keys(t).forEach((function(n){var r=St([],_t(t[n].values()));r.length&&(e[n]=r)})),Object.keys(e).length?e:void 0}var Mt=function(){function t(t){this._attributeEditor=t}return t.prototype.set=function(t){return mt(this,void 0,void 0,(function(){var e;return wt(this,(function(n){switch(n.label){case 0:return[4,this._attributeEditor()];case 1:e=n.sent(),Object.entries(t).forEach((function(t){var n=_t(t,2),r=n[0],i=n[1];return e.set(r,i)})),n.label=2;case 2:return n.trys.push([2,4,,5]),[4,e.apply()];case 3:return n.sent(),[2,!0];case 4:return n.sent(),[2,!1];case 5:return[2]}}))}))},t.prototype.remove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return mt(this,void 0,void 0,(function(){var e;return wt(this,(function(n){switch(n.label){case 0:return[4,this._attributeEditor()];case 1:e=n.sent(),t.forEach((function(t){return e.remove(t)})),n.label=2;case 2:return n.trys.push([2,4,,5]),[4,e.apply()];case 3:return n.sent(),[2,!0];case 4:return n.sent(),[2,!1];case 5:return[2]}}))}))},t}();var kt=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),At=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Tt=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Ct=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},It=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},jt=function(t){function e(e){var n=t.call(this)||this;return n.storeName=e,n._tagList={},n.tagMap=new Map,n._load(),n}return kt(e,t),e.prototype.has=function(t,e){void 0===e&&(e="device"),console.warn("Tags.has() is deprecated, and will be removed in a future version.");var n=this.tagMap.get(e);return!!n&&n.has(t)},e.prototype.add=function(t,e){var n;return void 0===e&&(e=""),At(this,void 0,void 0,(function(){return Tt(this,(function(r){switch(r.label){case 0:return[4,M()];case 1:return r.sent()?(e=this._validateGroup(e),this.has(t,e)?[2,!0]:(this.tagMap.has(e)?null===(n=this.tagMap.get(e))||void 0===n||n.add(t):this.tagMap.set(e,new Set([t])),[2,this._send(ot.ADD,[t],e)])):(console.warn("Data collection is disabled. Adding tags is not allowed."),[2,!1])}}))}))},e.prototype.remove=function(t,e){var n;return void 0===e&&(e=""),At(this,void 0,void 0,(function(){return Tt(this,(function(r){return e=this._validateGroup(e),this.has(t,e)?(null===(n=this.tagMap.get(e))||void 0===n||n.delete(t),[2,this._send(ot.REMOVE,[t],e)]):[2,!0]}))}))},e.prototype.clear=function(){this.tagMap=new Map,this.set([],"device")},e.prototype.set=function(t,e){return void 0===e&&(e=""),At(this,void 0,void 0,(function(){return Tt(this,(function(n){switch(n.label){case 0:return[4,M()];case 1:return!n.sent()&&t.length?(console.warn("Data collection is disabled. Setting tags is not allowed."),[2,!1]):(e=this._validateGroup(e),this.tagMap.set(e,new Set(t)),[2,this._send(ot.SET,t,e)])}}))}))},Object.defineProperty(e.prototype,"list",{get:function(){var t,e;console.warn("Tags.list is deprecated, and will be removed in a future version.");var n={};try{for(var r=Ct(this.tagMap),i=r.next();!i.done;i=r.next()){var o=It(i.value,2),a=o[0],s=o[1];s.size&&(n[a]=Array.from(s))}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return n},enumerable:!1,configurable:!0}),e.prototype._load=function(t){var e,n;void 0===t&&(t=et.getJSON(this.storeName));var r=new Map;try{if(t)try{for(var i=Ct(Object.keys(t)),o=i.next();!o.done;o=i.next()){var a=o.value;r.set(a,new Set(t[a]))}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}}catch(t){u("Error loading tags:",t)}return this.tagMap=r,this.tagMap},e.prototype._send=function(t,e,n){return At(this,void 0,void 0,(function(){return Tt(this,(function(r){return this._store(),[2,this._apply(t,e,n)]}))}))},e.prototype.sync=function(t){this._load(t),this._store()},e.prototype._store=function(){var t=this.list;if(t!==this._tagList){et.setJSON("tags",t),this._tagList=t;var e=new CustomEvent("tags",{detail:t});this.dispatchEvent(e)}},e}(e.EventTarget);function Nt(t,e,n){var r=t.storeName,i=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return kt(r,t),r.prototype._apply=function(t,n,r){return e(t,n,r)},r.prototype._validateGroup=function(t){return n(t)},r}(jt);return new i(r)}var Rt=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Bt=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Lt=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},Ut=function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t},Dt=function(){function t(t){var e=this,n=t.getName,r=t.setName,i=t.getChannelId,o=t.getContact;this._contact=o,this._getName=n,this._setName=r,this._getChannelId=i,this._attributes=new Mt((function(){return Rt(e,void 0,void 0,(function(){return Bt(this,(function(t){switch(t.label){case 0:return[4,this._contact()];case 1:return[2,t.sent().editAttributes()]}}))}))})),this._tags=Nt({storeName:"namedUserTags"},(function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e._applyTags.apply(e,Ut([],Lt(t)))}),(function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e._validateTagGroup.apply(e,Ut([],Lt(t)))}))}return Object.defineProperty(t.prototype,"id",{get:function(){return console.warn("accessing the `id` of a named user may return a non-canonical response. its use is deprecated."),this._getName()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"attributes",{get:function(){return this._attributes},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"channelId",{get:function(){return this._getChannelId()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tags",{get:function(){return this._tags},enumerable:!1,configurable:!0}),t.prototype.set=function(t){return Rt(this,void 0,void 0,(function(){var e,n;return Bt(this,(function(r){switch(r.label){case 0:return[4,this._contact()];case 1:return[4,(e=r.sent())._namedUserIdEquals(t)];case 2:if(n=r.sent(),!t||n)return[2,!1];r.label=3;case 3:return r.trys.push([3,5,,6]),[4,e.identify(t)];case 4:return r.sent(),this._setName(t),[2,!0];case 5:return r.sent(),[2,!1];case 6:return[2]}}))}))},t.prototype.remove=function(){return Rt(this,void 0,void 0,(function(){var t;return Bt(this,(function(e){switch(e.label){case 0:return this._getName()?[4,this._contact()]:[2,!1];case 1:t=e.sent(),e.label=2;case 2:return e.trys.push([2,4,,5]),[4,t.reset()];case 3:return e.sent(),this._setName(null),[2,!0];case 4:return e.sent(),[2,!1];case 5:return[2]}}))}))},t.prototype._applyTags=function(t,e,n){return Rt(this,void 0,void 0,(function(){var r;return Bt(this,(function(i){switch(i.label){case 0:return[4,this._contact()];case 1:return[4,i.sent().editTags()];case 2:switch(r=i.sent(),t){case ot.ADD:r.add(n,e);break;case ot.REMOVE:r.remove(n,e);break;case ot.SET:r.set(n,e);break;default:throw new Error("invalid tag action: "+t)}i.label=3;case 3:return i.trys.push([3,5,,6]),[4,r.apply()];case 4:return i.sent(),[2,!0];case 5:return i.sent(),[2,!1];case 6:return[2]}}))}))},t.prototype._validateTagGroup=function(t){if(void 0===t&&(t=""),!t.trim())throw Error("group is mandatory.");if("device"===t)throw Error('"device" group is not available for a named user.');return t},t}();Dt.prototype.set=ht(Dt.prototype.set,1e3);var Ft=Dt,qt=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Gt=function(t){function e(n){void 0===n&&(n="Data collection is not enabled.");var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(r,e),r.name=r.constructor.name,r}return qt(e,t),e}(Error),Vt=function(t){function e(n){var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(r,e),r.name=r.constructor.name,r}return qt(e,t),e}(Error),Kt=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Wt=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Jt=function(){function t(t,e,n){this._client=t,this._channel=e,this._datCollectionEnabled=n}return t.prototype.list=function(){return Kt(this,void 0,void 0,(function(){var t;return Wt(this,(function(e){switch(e.label){case 0:return[4,this._channel()];case 1:return t=e.sent(),[2,this._client.listSubscriptions(t)]}}))}))},t.prototype.edit=function(){return Kt(this,void 0,void 0,(function(){var t,e=this;return Wt(this,(function(n){switch(n.label){case 0:return[4,this._channel()];case 1:return t=n.sent(),[2,(r=function(n){return Kt(e,void 0,void 0,(function(){return Wt(this,(function(e){switch(e.label){case 0:return[4,this._datCollectionEnabled()];case 1:if(!e.sent())throw new Gt;return[2,this._client.updateSubscriptions(t,n)]}}))}))},i=function(){function t(){this._mutations=[]}return t.prototype.apply=function(){return Kt(this,void 0,void 0,(function(){return Wt(this,(function(t){switch(t.label){case 0:return[4,r(this._mutations)];case 1:return t.sent(),[2]}}))}))},t.prototype.subscribe=function(t){this._mutations.push({action:"subscribe",listId:t,timestamp:rt()})},t.prototype.unsubscribe=function(t){this._mutations.push({action:"unsubscribe",listId:t,timestamp:rt()})},t}(),new i)]}var r,i}))}))},t}(),zt=Jt;var Ht=function(){return Ht=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},Ht.apply(this,arguments)},Qt=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},Zt=function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t};function Yt(t){var e=[];return t.reverse().filter((function(t){return!e.includes(t.listId)&&(e.push(t.listId),!0)})).reverse()}function Xt(t){return Yt(t).map(ne)}function $t(t,e){var n=Yt(e),r=Zt([],Qt(t));return n.forEach((function(t){var e=t.action,n=t.listId;"subscribe"!==e||r.includes(n)||r.push(n),"unsubscribe"===e&&r.includes(n)&&(r=r.filter((function(t){return t!==n})))})),r}function te(t){var e=[];return Zt([],Qt(t)).reverse().filter((function(t){return!e.find((function(e){return e.listId===t.listId&&e.scope===t.scope}))&&(e.push(t),!0)})).reverse()}function ee(t){return te(t).map(re)}function ne(t){return{action:t.action,list_id:t.listId,timestamp:t.timestamp}}function re(t){return{action:t.action,list_id:t.listId,timestamp:t.timestamp,scope:t.scope}}function ie(t,e){var n=Ht({},t);return te(e).forEach((function(t){var e=t.listId,r=t.scope,i=t.action;n[e]||(n[e]=[]),"subscribe"!==i||n[e].includes(r)||n[e].push(r),"unsubscribe"===i&&n[e].includes(r)&&(n[e]=n[e].filter((function(t){return t!==r}))),n[e].length||delete n[e]})),n}var oe=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},ae=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};function se(t,e){var n=(void 0===e?{}:e).defaultValue,r=void 0===n||n;if("boolean"==typeof t)return t;if(void 0===t)return r;try{return JSON.parse(t)}catch(t){return r}}var ue=function(){function t(t,e){this._config=t,this._request=e}return t.prototype.listSubscriptions=function(t){return oe(this,void 0,void 0,(function(){var e,n;return ae(this,(function(r){switch(r.label){case 0:return e=this._config.paths.list+"/"+t,[4,this._request.get(e)];case 1:if(!(n=r.sent()).ok)throw new Error("unexpected response");return[2,n.list_ids]}}))}))},t.prototype.updateSubscriptions=function(t,e){return oe(this,void 0,void 0,(function(){var n,r;return ae(this,(function(i){switch(i.label){case 0:return e.length?(n=this._config.paths.update,r={subscription_lists:Xt(e),audience:{web_channel:t}},[4,this._request.post(n,r)]):[2];case 1:return i.sent(),[2]}}))}))},t}(),ce=function(){function t(t,e,n){this._client=t,this._cache=e,this._mutationCache=n}return t.prototype.updateSubscriptions=function(t,e){return oe(this,void 0,void 0,(function(){var n=this;return ae(this,(function(r){switch(r.label){case 0:return[4,this._client.updateSubscriptions(t,e)];case 1:return r.sent(),e.forEach((function(t){return n._mutationCache.push(t)})),this._cache.invalidate(this._listKey(t)),[2]}}))}))},t.prototype.listSubscriptions=function(t){return oe(this,void 0,void 0,(function(){var e,n,r=this;return ae(this,(function(i){switch(i.label){case 0:return[4,this._cache.get(this._listKey(t),(function(){return r._client.listSubscriptions(t)}))];case 1:return e=i.sent(),n=this._mutationCache.values(),[2,$t(e,n)]}}))}))},t.prototype._listKey=function(t){return t+":subscription_lists"},t.createClient=function(e,n,r,i){return new t(new ue(e,n),r,i)},t}(),le=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),fe=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},pe=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},de=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},he=function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t},ve=function(t){function e(e,n){var r=t.call(this)||this;return r.opt_in=!0,r.namedUserChanges=0,r._contact=e,r.channel_id=n.channel_id,r._named_user_id=null,r._tags=Nt({storeName:"tags"},(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return r._applyTags.apply(r,he([],de(t)))}),(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return r._validateTagGroup.apply(r,he([],de(t)))})),r._attributes=new dt((function(){return{channel:r.channel_id}})),r._namedUser=new Ft({getName:function(){return r._named_user_id},setName:function(t){r.set({named_user_id:t})},getChannelId:function(){return r.channel_id},getContact:function(){return r._contact()}}),r.set(n),r}return le(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.channel_id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"optedIn",{get:function(){return se(this.opt_in)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"named_user_id",{get:function(){return console.warn("accessing the `named_user_id` of a channel may return a non-canonical response. its use is deprecated."),this._named_user_id},enumerable:!1,configurable:!0}),e.prototype._createSubscriptionManager=function(){var t=this,e=new R({prefix:o.storagePrefix,ttlMs:o.subscriptionLists.cacheTtlMs},self.sessionStorage),n=new B(e),r=new L({indexKey:"channel",keyFn:function(t){return t.listId}},e),i=ce.createClient({paths:o.paths.subscription_lists},X(o),n,r);return new zt(i,(function(){return fe(t,void 0,void 0,(function(){return pe(this,(function(t){return[2,this.channel_id]}))}))}),(function(){return M()}))},Object.defineProperty(e.prototype,"subscriptions",{get:function(){return this._subscriptions||(this._subscriptions=this._createSubscriptionManager()),this._subscriptions},enumerable:!1,configurable:!0}),e.fromStorage=function(t){return fe(this,void 0,void 0,(function(){var n;return pe(this,(function(r){switch(r.label){case 0:return[4,d.get("channel")];case 1:return(n=r.sent())?[2,new e(t,n)]:[2]}}))}))},e.prototype.optOut=function(){return fe(this,void 0,void 0,(function(){return pe(this,(function(t){switch(t.label){case 0:return[4,this.set({opt_in:!1})];case 1:return t.sent(),[2,this.update(!1)]}}))}))},Object.defineProperty(e.prototype,"namedUser",{get:function(){return this._namedUser},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return o.paths.cra+"/"+this.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tags",{get:function(){return this._tags},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"attributes",{get:function(){return this._attributes},enumerable:!1,configurable:!0}),e.prototype._setLocaleOverride=function(t){this.localeOverride=t},e.prototype.toJSON=function(){return Object.assign(P({optedIn:this.optedIn,localeOverride:this.localeOverride}),{channel_id:this.id,opt_in:this.optedIn})},e.prototype._set=function(t){return console.warn("Channel._set() is deprecated and will be removed in the future. Please use Channel.set() instead."),this.set(t)},e.prototype.set=function(t){var e=Object.keys(t).every((function(t){return"named_user_id"===t}));return e&&this.namedUserChanges++,t.channel_id&&(this.channel_id=t.channel_id),void 0!==t.opt_in?this.opt_in=t.opt_in:this.opt_in=!0,void 0!==t.named_user_id&&(this._named_user_id=t.named_user_id),this._store(e)},e.prototype._store=function(t){return fe(this,void 0,void 0,(function(){var e,n,r,i;return pe(this,(function(o){switch(o.label){case 0:return[4,M()];case 1:if(!o.sent())return console.warn("Data collection is disabled. Skipping channel storage."),[2,!1];e={channel_id:this.id,opt_in:this.optedIn,named_user_id:this._named_user_id},et.setJSON("channel",e),o.label=2;case 2:return o.trys.push([2,6,,7]),this.localeOverride?[3,4]:(n=this,[4,b.fromStorage()]);case 3:n.localeOverride=o.sent(),o.label=4;case 4:return[4,d.set("channel",e)];case 5:return o.sent(),t&&this.namedUserChanges>10?(console.error("Airship SDK: Maximum named user changes reached"),[2,!1]):(r=new CustomEvent("channel",{detail:this}),this.dispatchEvent(r),[2,!0]);case 6:return i=o.sent(),console.error("Airship SDK: Error while storing channel",i),[2,!1];case 7:return[2]}}))}))},e.prototype._update=function(t){return void 0===t&&(t=!0),console.warn("Channel._update() is deprecated and will be removed in the future. Please use Channel.update() instead."),this.update(t)},e.prototype.update=function(t){return void 0===t&&(t=!0),fe(this,void 0,void 0,(function(){var e,n;return pe(this,(function(r){switch(r.label){case 0:return e=this.toJSON(),t&&delete e.opt_in,[4,M()];case 1:if(!r.sent())return console.warn("Data collection is disabled. Skipping channel update."),[2,!1];r.label=2;case 2:return r.trys.push([2,4,,5]),[4,U(this.path,{method:"put",body:{channel:e}})];case 3:return r.sent(),[2,!0];case 4:return n=r.sent(),console.error("Airship SDK: Error while updating channel",n),[2,!1];case 5:return[2]}}))}))},e.prototype._applyTags=function(t,e,n){return fe(this,void 0,void 0,(function(){var r,i,a;return pe(this,(function(s){switch(s.label){case 0:(i={audience:{web_channel:this.channel_id}})[t]=((a={})[n]=e,a),r=i,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,U(o.paths.tags,{method:"post",body:r})];case 2:return[2,s.sent().ok];case 3:return s.sent(),[2,!1];case 4:return[2]}}))}))},e.prototype._validateTagGroup=function(t){return t||"device"},e}(e.EventTarget),ye=ve,be=["web","email","sms","open","ios","android","amazon"];var ge=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},me=function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t};function we(t,e){return new(function(){function n(){this._mutations=me([],ge(t))}return n.prototype.apply=function(){return e(this._mutations)},n.prototype.remove=function(t){this._mutations.push({action:"remove",key:t,timestamp:rt()})},n.prototype.set=function(t,e){this._mutations.push({action:"set",key:t,value:e,timestamp:rt()})},n}())}var _e=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Se=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Pe=function(){function t(t,e,n){this._client=t,this._cache=e,this._mutationCache=n}return t.prototype.identify=function(t,e,n){return this._client.identify(t,e,n)},t.prototype.resolve=function(t,e){return this._client.resolve(t,e)},t.prototype.reset=function(t,e){return this._client.reset(t,e)},t.prototype.updateAttributes=function(t,e){return this._client.updateAttributes(t,e)},t.prototype.updateTags=function(t,e){return this._client.updateTags(t,e)},t.prototype._subscriptionCacheKey=function(t){return t+":subscription_lists"},t.prototype.listSubscriptions=function(t){return _e(this,void 0,void 0,(function(){var e,n,r=this;return Se(this,(function(i){switch(i.label){case 0:return[4,this._cache.get(this._subscriptionCacheKey(t),(function(){return r._client.listSubscriptions(t)}))];case 1:return e=i.sent(),n=this._mutationCache.values(),[2,ie(e,n)]}}))}))},t.prototype.updateSubscriptions=function(t,e){return _e(this,void 0,void 0,(function(){var n=this;return Se(this,(function(r){switch(r.label){case 0:return[4,this._client.updateSubscriptions(t,e)];case 1:return r.sent(),e.forEach((function(t){n._mutationCache.push(t)})),this._cache.invalidate(this._subscriptionCacheKey(t)),[2]}}))}))},t.prototype.associateChannel=function(t,e){return this._client.associateChannel(t,e)},t}(),xe=function(){function t(t,e){this._config=t,this._request=e}return t.prototype.identify=function(t,e,n){var r=void 0===n?{}:n,i=r.platform,o=void 0===i?"web":i,a=r.contactId;return _e(this,void 0,void 0,(function(){var n,r;return Se(this,(function(i){switch(i.label){case 0:return n=this._config.paths.identify,r={named_user_id:t,channel_id:e,device_type:o},a&&(r.contact_id=a),[4,this._request.post(n,r)];case 1:return[2,i.sent().contact_id]}}))}))},t.prototype.resolve=function(t,e){var n=(void 0===e?{}:e).platform,r=void 0===n?"web":n;return _e(this,void 0,void 0,(function(){var e,n,i;return Se(this,(function(o){switch(o.label){case 0:return e=this._config.paths.resolve,n={channel_id:t,device_type:r},[4,this._request.post(e,n)];case 1:return[2,[(i=o.sent()).contact_id,i.is_anonymous]]}}))}))},t.prototype.reset=function(t,e){var n=(void 0===e?{}:e).platform,r=void 0===n?"web":n;return _e(this,void 0,void 0,(function(){var e,n;return Se(this,(function(i){switch(i.label){case 0:return e=this._config.paths.reset,n={channel_id:t,device_type:r},[4,this._request.post(e,n)];case 1:return[2,i.sent().contact_id]}}))}))},t.prototype.updateAttributes=function(t,e){return _e(this,void 0,void 0,(function(){return Se(this,(function(n){return[2,this._batch(t,{attributes:e})]}))}))},t.prototype.updateTags=function(t,e){return _e(this,void 0,void 0,(function(){return Se(this,(function(n){return[2,this._batch(t,{tags:e})]}))}))},t.prototype.listSubscriptions=function(t){return _e(this,void 0,void 0,(function(){var e,n;return Se(this,(function(r){switch(r.label){case 0:return e=this._config.paths.subscription_lists_list+"/"+t,[4,this._request.get(e)];case 1:return n=r.sent(),[2,(i=n.subscription_lists,o={},i.forEach((function(t){var e=t.scope;t.list_ids.forEach((function(t){o[t]?o[t].push(e):o[t]=[e]}))})),o)]}var i,o}))}))},t.prototype.updateSubscriptions=function(t,e){return _e(this,void 0,void 0,(function(){return Se(this,(function(n){switch(n.label){case 0:return[4,this._batch(t,{subscriptionLists:e})];case 1:return n.sent(),[2]}}))}))},t.prototype._batch=function(t,e){var n=e.attributes,r=void 0===n?[]:n,i=e.tags,o=void 0===i?[]:i,a=e.associate,s=void 0===a?[]:a,u=e.subscriptionLists,c=void 0===u?[]:u;return _e(this,void 0,void 0,(function(){var e,n;return Se(this,(function(i){switch(i.label){case 0:return e=this._config.paths.batch+"/"+t,n={},r.length&&(n.attributes=Pt(r)),o.length&&(n.tags=xt(o)),c.length&&(n.subscription_lists=ee(c)),s.length&&(n.associate=s.map((function(t){return{channel_id:t.channelId,device_type:t.platform}}))),[4,this._request.post(e,n)];case 1:return i.sent(),[2]}}))}))},t.prototype.associateChannel=function(t,e){return _e(this,void 0,void 0,(function(){return Se(this,(function(n){return[2,this._batch(t,{associate:[e]})]}))}))},t}();var Ee=function(){return Ee=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},Ee.apply(this,arguments)},Oe=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Me=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},ke=function(){function t(t,e){this._config=t,this._request=e}return t.prototype.registerEmail=function(t,e){return Oe(this,void 0,void 0,(function(){var n,r;return Me(this,(function(i){return n=Ee({type:"email",address:t,transactional_opted_in:Ce(e.transactionalOptedIn)},Te(e)),function(t){return!t.doubleOptIn}(e)&&(n.commercial_opted_in=Ce(e.commercialOptedIn)),r={},function(t){return Boolean(t.doubleOptIn)}(e)&&(r.opt_in_mode="double"),e.properties&&(r.properties=e.properties),[2,this._register(this._config.paths.email,n,{registrationOptions:r})]}))}))},t.prototype.registerSms=function(t,e){return Oe(this,void 0,void 0,(function(){var n;return Me(this,(function(r){switch(r.label){case 0:return n=Ee({msisdn:t,sender:e.senderId},Te(e)),[4,this._request.post(this._config.paths.sms,n)];case 1:return[2,r.sent().channel_id]}}))}))},t.prototype.registerOpen=function(t,e){return Oe(this,void 0,void 0,(function(){var n;return Me(this,(function(r){return n=Ee({type:"open",address:t,opt_in:!0,open:{open_platform_name:e.platformName,identifiers:e.identifiers}},Te(e)),[2,this._register(this._config.paths.open,n)]}))}))},t.prototype._register=function(t,e,n){var r=(void 0===n?{}:n).registrationOptions;return Oe(this,void 0,void 0,(function(){var n;return Me(this,(function(i){switch(i.label){case 0:return n=Ee({channel:e},r),[4,this._request.post(t,n)];case 1:return[2,i.sent().channel_id]}}))}))},t}(),Ae=ke;function Te(t){return{timezone:t.timezone,locale_country:t.localeCountry,locale_language:t.localeLanguage}}function Ce(t){if(t)return rt(t)}var Ie=n(257),je=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Ne=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Re=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},Be=function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t},Le="contact.id",Ue="contact.name",De="contact.named_user_associated",Fe="contact.pending_tag_mutations",qe="contact.pending_attribute_mutations",Ge="contact.pending_subscription_list_mutations",Ve=function(t){return"contact."+t+".tag_mutations"},Ke=function(t){return"contact."+t+".attribute_mutations"},We=function(t){return"contact."+t+".subscription_list_mutations"},Je="session_resolved_timestamp",ze=function(t){return"contact."+t+".associated_channels"},He=function(){function t(t,e,n){var r=t.prefix,i=t.sessionLengthMs,o=t.namedUserTtlMs,a=t._forceExpireNamedUsers,s=t._getNow;this._db=e,this._session=n,this._prefix=r,this._sessionLengthMs=i,this._namedUserTtlMs=o,this._forceExpireNamedUsers=a,this._getNow=null!=s?s:function(){return Date.now()}}return t.prototype._key=function(t){return this._prefix+":"+t},t.prototype.sessionResolved=function(){var t,e;return je(this,void 0,void 0,(function(){var n,r,i;return Ne(this,(function(o){return n=this._key(Je),(r=null===(t=this._session)||void 0===t?void 0:t.getItem(n))?(i=Number.parseInt(r,10),Number.isNaN(i)?(null===(e=this._session)||void 0===e||e.removeItem(n),[2,!1]):[2,this._getNow()-i<this._sessionLengthMs]):[2,!1]}))}))},t.prototype.setSessionResolved=function(t){var e,n;return je(this,void 0,void 0,(function(){var r;return Ne(this,(function(i){return r=this._key(Je),[2,t?null===(e=this._session)||void 0===e?void 0:e.setItem(r,String(this._getNow())):null===(n=this._session)||void 0===n?void 0:n.removeItem(r)]}))}))},t.prototype.getOrCreateContactId=function(){return je(this,void 0,void 0,(function(){var t;return Ne(this,(function(e){switch(e.label){case 0:return[4,this._db.get(Le)];case 1:return(t=e.sent())?[3,3]:(t=(0,Ie.v4)(),[4,this.setContactId(t)]);case 2:e.sent(),e.label=3;case 3:return[2,t]}}))}))},t.prototype.setContactId=function(t){return je(this,void 0,void 0,(function(){return Ne(this,(function(e){switch(e.label){case 0:return[4,this._db.set(Le,t)];case 1:return e.sent(),[2]}}))}))},t.prototype.clearContactId=function(){return je(this,void 0,void 0,(function(){var t;return Ne(this,(function(e){switch(e.label){case 0:return t=(0,Ie.v4)(),[4,this._db.set(Le,t)];case 1:return e.sent(),[2,t]}}))}))},t.prototype.getNamedUserId=function(){return je(this,void 0,void 0,(function(){var t,e;return Ne(this,(function(n){switch(n.label){case 0:return[4,this.getNamedUserAssociatedTimestamp()];case 1:return!(t=n.sent())&&this._forceExpireNamedUsers||t&&this._getNow()-t>this._namedUserTtlMs?[2]:[4,this._db.get(Ue)];case 2:return(e=n.sent())&&!t&&this.setNamedUserAssociatedTimestamp(),[2,e]}}))}))},t.prototype.setNamedUserId=function(t){return je(this,void 0,void 0,(function(){return Ne(this,(function(e){switch(e.label){case 0:return[4,this._db.set(Ue,t)];case 1:return e.sent(),[4,this.setNamedUserAssociatedTimestamp()];case 2:return e.sent(),[2]}}))}))},t.prototype.clearNamedUserId=function(){return je(this,void 0,void 0,(function(){return Ne(this,(function(t){switch(t.label){case 0:return[4,this._db.remove(Ue)];case 1:return t.sent(),[4,this.clearNamedUserAssociatedTimestamp()];case 2:return t.sent(),[2]}}))}))},t.prototype.setNamedUserAssociatedTimestamp=function(){return je(this,void 0,void 0,(function(){return Ne(this,(function(t){return this._db.set(De,String(this._getNow())),[2]}))}))},t.prototype.clearNamedUserAssociatedTimestamp=function(){return je(this,void 0,void 0,(function(){return Ne(this,(function(t){return this._db.remove(De),[2]}))}))},t.prototype.getNamedUserAssociatedTimestamp=function(){return je(this,void 0,void 0,(function(){var t,e;return Ne(this,(function(n){switch(n.label){case 0:return[4,this._db.get(De)];case 1:return(t=n.sent())?(e=Number.parseInt(t,10),Number.isNaN(e)?[4,this.clearNamedUserAssociatedTimestamp()]:[3,3]):[2];case 2:return n.sent(),[2];case 3:return[2,e]}}))}))},t.prototype.getPendingTagMutations=function(){return je(this,void 0,void 0,(function(){var t;return Ne(this,(function(e){switch(e.label){case 0:return[4,this._db.get(Fe)];case 1:return[2,null!=(t=e.sent())?t:[]]}}))}))},t.prototype.setPendingTagMutations=function(t){return je(this,void 0,void 0,(function(){return Ne(this,(function(e){switch(e.label){case 0:return[4,this._db.set(Fe,t)];case 1:return e.sent(),[2]}}))}))},t.prototype.appendTagMutations=function(t,e){return je(this,void 0,void 0,(function(){var n;return Ne(this,(function(r){switch(r.label){case 0:return[4,this.getTagMutations(t)];case 1:return n=r.sent(),[4,this._db.set(Ve(t),n.concat.apply(n,Be([],Re(e))))];case 2:return r.sent(),[2]}}))}))},t.prototype.getTagMutations=function(t){return je(this,void 0,void 0,(function(){var e;return Ne(this,(function(n){switch(n.label){case 0:return[4,this._db.get(Ve(t))];case 1:return[2,null!=(e=n.sent())?e:[]]}}))}))},t.prototype.getPendingAttributeMutations=function(){return je(this,void 0,void 0,(function(){var t;return Ne(this,(function(e){switch(e.label){case 0:return[4,this._db.get(qe)];case 1:return[2,null!=(t=e.sent())?t:[]]}}))}))},t.prototype.setPendingAttributeMutations=function(t){return je(this,void 0,void 0,(function(){return Ne(this,(function(e){switch(e.label){case 0:return[4,this._db.set(qe,t)];case 1:return e.sent(),[2]}}))}))},t.prototype.appendAttributeMutations=function(t,e){return je(this,void 0,void 0,(function(){var n;return Ne(this,(function(r){switch(r.label){case 0:return[4,this.getAttributeMutations(t)];case 1:return n=r.sent(),[4,this._db.set(Ke(t),n.concat.apply(n,Be([],Re(e))))];case 2:return r.sent(),[2]}}))}))},t.prototype.getAttributeMutations=function(t){return je(this,void 0,void 0,(function(){var e;return Ne(this,(function(n){switch(n.label){case 0:return[4,this._db.get(Ke(t))];case 1:return[2,null!=(e=n.sent())?e:[]]}}))}))},t.prototype.getPendingSubscriptionListMutations=function(){return je(this,void 0,void 0,(function(){var t;return Ne(this,(function(e){switch(e.label){case 0:return[4,this._db.get(Ge)];case 1:return[2,null!=(t=e.sent())?t:[]]}}))}))},t.prototype.setPendingSubscriptionListMutations=function(t){return je(this,void 0,void 0,(function(){return Ne(this,(function(e){switch(e.label){case 0:return[4,this._db.set(Ge,t)];case 1:return e.sent(),[2]}}))}))},t.prototype.appendSubscriptionListMutations=function(t,e){return je(this,void 0,void 0,(function(){var n;return Ne(this,(function(r){switch(r.label){case 0:return[4,this.getSubscriptionListMutations(t)];case 1:return n=r.sent(),[4,this._db.set(We(t),n.concat.apply(n,Be([],Re(e))))];case 2:return r.sent(),[2]}}))}))},t.prototype.getSubscriptionListMutations=function(t){return je(this,void 0,void 0,(function(){var e;return Ne(this,(function(n){switch(n.label){case 0:return[4,this._db.get(We(t))];case 1:return[2,null!=(e=n.sent())?e:[]]}}))}))},t.prototype.getAssociatedChannels=function(t){return je(this,void 0,void 0,(function(){var e;return Ne(this,(function(n){switch(n.label){case 0:return[4,this._db.get(ze(t))];case 1:return[2,null!=(e=n.sent())?e:[]]}}))}))},t.prototype.appendAssociatedChannel=function(t,e){return je(this,void 0,void 0,(function(){var n;return Ne(this,(function(r){switch(r.label){case 0:return[4,this.getAssociatedChannels(t)];case 1:return n=r.sent(),[4,this._db.set(ze(t),Be(Be([],Re(n)),[e]))];case 2:return r.sent(),[2]}}))}))},t.prototype.clearAssociatedChannels=function(t){return je(this,void 0,void 0,(function(){return Ne(this,(function(e){switch(e.label){case 0:return[4,this._db.remove(ze(t))];case 1:return e.sent(),[2]}}))}))},t}(),Qe=He,Ze=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Ye=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Xe=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},$e=function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t},tn=function(){function t(t,e,n,r,i){this._client=t,this._storage=e,this._contact=n,this._dataCollectionEnabled=r,this._isRelevantToAirship=i}return t.prototype.list=function(){return Ze(this,void 0,void 0,(function(){var t;return Ye(this,(function(e){switch(e.label){case 0:return[4,this._contact()];case 1:return t=e.sent(),[2,this._client.listSubscriptions(t)]}}))}))},t.prototype.edit=function(){return Ze(this,void 0,void 0,(function(){var t,e,n,r=this;return Ye(this,(function(i){switch(i.label){case 0:return[4,this._contact()];case 1:return t=i.sent(),e=function(e){return Ze(r,void 0,void 0,(function(){return Ye(this,(function(n){switch(n.label){case 0:return[4,this._dataCollectionEnabled()];case 1:if(!n.sent())throw new Gt;return[4,this._isRelevantToAirship()];case 2:return n.sent()?[3,4]:[4,this._storage.setPendingSubscriptionListMutations(e)];case 3:return n.sent(),[2];case 4:return e.length?[4,this._client.updateSubscriptions(t,e)]:[3,8];case 5:return n.sent(),[4,this._storage.setPendingSubscriptionListMutations([])];case 6:return n.sent(),[4,this._storage.appendSubscriptionListMutations(t,e)];case 7:n.sent(),n.label=8;case 8:return[2]}}))}))},n=nn,[4,this._storage.getPendingSubscriptionListMutations()];case 2:return[2,n.apply(void 0,[i.sent(),e])]}}))}))},t}(),en=tn;function nn(t,e){return new(function(){function n(){this._mutations=$e([],Xe(t))}return n.prototype.apply=function(){return Ze(this,void 0,void 0,(function(){return Ye(this,(function(t){switch(t.label){case 0:return[4,e(this._mutations)];case 1:return t.sent(),[2]}}))}))},n.prototype.subscribe=function(t,e){this._mutations.push({action:"subscribe",listId:t,timestamp:rt(),scope:e})},n.prototype.unsubscribe=function(t,e){this._mutations.push({action:"unsubscribe",listId:t,timestamp:rt(),scope:e})},n}())}var rn=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},on=function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t},an=["device"],sn=["ua_"];function un(t,e){return new(function(){function n(){this._mutations=on([],rn(t))}return n.prototype.apply=function(){return e(this._mutations)},n.prototype.add=function(t,e){cn(t);var n=Array.isArray(e)?e:[e];this._mutations.push({action:"add",tags:n,group:t,timestamp:rt()})},n.prototype.remove=function(t,e){cn(t);var n=Array.isArray(e)?e:[e];this._mutations.push({action:"remove",tags:n,group:t,timestamp:rt()})},n.prototype.set=function(t,e){cn(t);var n=Array.isArray(e)?e:[e];this._mutations.push({action:"set",tags:n,group:t,timestamp:rt()})},n}())}function cn(t){if(an.includes(t))throw new gt("invalid tag group for contact: "+t);if(sn.some((function(e){return t.startsWith(e)})))throw new gt("forbidden tag group prefix for contact: "+t)}var ln=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),fn=function(){return fn=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},fn.apply(this,arguments)},pn=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},dn=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},hn=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},vn=function(e){function n(n,r,i,o,a,s,u,c){var l,f=e.call(this)||this;return f._channel=n,f._locale=r,f._storage=i,f._client=o,f._registration=a,f._flags=s,f._lifecycle=u,f._emitter=c,f._mutex=new t.Z,f._ready=f._init(),null===(l=f._emitter)||void 0===l||l.addEventListener("channel",(function(t){return f._onChannel(t)})),f}return ln(n,e),n.prototype.contactId=function(){return pn(this,void 0,void 0,(function(){var t=this;return dn(this,(function(e){switch(e.label){case 0:return[4,this._ready];case 1:return e.sent(),[2,this._mutex.acquireAsync().then((function(){return t._storage.getOrCreateContactId()})).finally((function(){return t._mutex.release()}))]}}))}))},n.prototype._init=function(){return pn(this,void 0,void 0,(function(){var t,e,n,r;return dn(this,(function(i){switch(i.label){case 0:return[4,this._channel()];case 1:return t=i.sent(),[4,this._storage.getNamedUserId()];case 2:return e=i.sent(),t?[4,this._migrate(t,e)]:(u("contact: initialized without channel"),[2]);case 3:return i.sent()?(u("contact: successful migration"),[2]):[4,this._resolve(t.id)];case 4:return n=hn.apply(void 0,[i.sent(),1]),r=n[0],[4,this._applyPendingAttributeMutations(r)];case 5:return i.sent(),[4,this._applyPendingTagMutations(r)];case 6:return i.sent(),[4,this._applyPendingSubscriptionListMutations(r)];case 7:return i.sent(),u("contact: initialized"),[2]}}))}))},n.prototype.identify=function(t){return pn(this,void 0,void 0,(function(){var e=this;return dn(this,(function(n){switch(n.label){case 0:return[4,this._ready];case 1:return n.sent(),function(t){if("string"!=typeof t)throw new bt("must be a string");if(!t.trim())throw new bt("must not be blank")}(t),[2,this._mutex.acquireAsync().then((function(){return e._identify(t)})).then((function(n){return e._lifecycle.accept("contact",Date.now(),{contactId:n,type:"identify",id:t})})).finally((function(){return e._mutex.release()}))]}}))}))},n.prototype._identify=function(t){return pn(this,void 0,void 0,(function(){var e,n,r;return dn(this,(function(i){switch(i.label){case 0:return[4,this._namedUserIdEquals(t)];case 1:return i.sent()?(u("contact: identify, not setting as user is already identified"),[2,this._storage.getOrCreateContactId()]):[4,this._storage.getNamedUserId()];case 2:return i.sent()?(u("contact: identify, this contact already has a named user. Creating new contact."),[4,this._storage.clearContactId()]):[3,5];case 3:return e=i.sent(),[4,this._resetStoredContact(e)];case 4:i.sent(),i.label=5;case 5:return[4,this._nonCanonicalChannelId()];case 6:if(!(n=i.sent()))throw new yt;return[4,this._doIdentify(t,n)];case 7:return r=i.sent(),u("contact: identified",t,n,r),[2,r]}}))}))},n.prototype._namedUserIdEquals=function(t){return pn(this,void 0,void 0,(function(){var e;return dn(this,(function(n){switch(n.label){case 0:return e=t,[4,this._storage.getNamedUserId()];case 1:return[2,e===n.sent()]}}))}))},n.prototype.reset=function(){return pn(this,void 0,void 0,(function(){var t=this;return dn(this,(function(e){switch(e.label){case 0:return[4,this._ready];case 1:return e.sent(),[4,this._mutex.acquireAsync().then((function(){return t._reset()})).then((function(e){return t._lifecycle.accept("contact",Date.now(),{contactId:e,type:"reset"})})).finally((function(){return t._mutex.release()}))];case 2:return e.sent(),[2]}}))}))},n.prototype._reset=function(){return pn(this,void 0,void 0,(function(){var t;return dn(this,(function(e){switch(e.label){case 0:return[4,this._channel()];case 1:return t=e.sent(),[4,this._doReset(null==t?void 0:t.id)];case 2:return[2,e.sent()]}}))}))},n.prototype.editAttributes=function(){return pn(this,void 0,void 0,(function(){var t,e,n=this;return dn(this,(function(r){switch(r.label){case 0:return[4,this._ready];case 1:return r.sent(),[4,this._storage.getOrCreateContactId()];case 2:return t=r.sent(),e=we,[4,this._storage.getPendingAttributeMutations()];case 3:return[2,e.apply(void 0,[r.sent(),function(e){return pn(n,void 0,void 0,(function(){return dn(this,(function(n){switch(n.label){case 0:return[4,this._flags.isDataCollectionEnabled()];case 1:if(!n.sent())throw new Gt;return[4,this._isRelevantToAirship()];case 2:return n.sent()?[3,4]:[4,this._storage.setPendingAttributeMutations(e)];case 3:case 5:return n.sent(),[2];case 4:return[4,this._applyPendingAttributeMutations(t,e)]}}))}))}])]}}))}))},n.prototype._applyPendingAttributeMutations=function(t,e){return pn(this,void 0,void 0,(function(){var n,r;return dn(this,(function(i){switch(i.label){case 0:return null==e?[3,1]:(r=e,[3,3]);case 1:return[4,this._storage.getPendingAttributeMutations()];case 2:r=i.sent(),i.label=3;case 3:return(n=r).length?[4,this._client.updateAttributes(t,n)]:[3,7];case 4:return i.sent(),[4,this._storage.setPendingAttributeMutations([])];case 5:return i.sent(),[4,this._storage.appendAttributeMutations(t,n)];case 6:i.sent(),this._lifecycle.accept("contact",Date.now(),{contactId:t,type:"attribute_mutation",mutations:n,outcome:Pt(n)}),i.label=7;case 7:return[2]}}))}))},n.prototype.editTags=function(){return pn(this,void 0,void 0,(function(){var t,e,n=this;return dn(this,(function(r){switch(r.label){case 0:return[4,this._ready];case 1:return r.sent(),[4,this._storage.getOrCreateContactId()];case 2:return t=r.sent(),e=un,[4,this._storage.getPendingTagMutations()];case 3:return[2,e.apply(void 0,[r.sent(),function(e){return pn(n,void 0,void 0,(function(){return dn(this,(function(n){switch(n.label){case 0:return[4,this._flags.isDataCollectionEnabled()];case 1:if(!n.sent())throw new Gt;return[4,this._isRelevantToAirship()];case 2:return n.sent()?[3,4]:[4,this._storage.setPendingTagMutations(e)];case 3:case 5:return n.sent(),[2];case 4:return[4,this._applyPendingTagMutations(t,e)]}}))}))}])]}}))}))},n.prototype._applyPendingTagMutations=function(t,e){return pn(this,void 0,void 0,(function(){var n,r;return dn(this,(function(i){switch(i.label){case 0:return null==e?[3,1]:(r=e,[3,3]);case 1:return[4,this._storage.getPendingTagMutations()];case 2:r=i.sent(),i.label=3;case 3:return(n=r).length?[4,this._client.updateTags(t,n)]:[3,7];case 4:return i.sent(),[4,this._storage.setPendingTagMutations([])];case 5:return i.sent(),[4,this._storage.appendTagMutations(t,n)];case 6:i.sent(),this._lifecycle.accept("contact",Date.now(),{contactId:t,type:"tag_mutation",mutations:n,outcome:xt(n)}),i.label=7;case 7:return[2]}}))}))},n.prototype._createSubscriptionManager=function(){var t=this;return new en(this._client,this._storage,(function(){return pn(t,void 0,void 0,(function(){return dn(this,(function(t){switch(t.label){case 0:return[4,this._ready];case 1:return t.sent(),[2,this._storage.getOrCreateContactId()]}}))}))}),(function(){return t._flags.isDataCollectionEnabled()}),(function(){return t._isRelevantToAirship()}))},Object.defineProperty(n.prototype,"subscriptions",{get:function(){return this._subscriptions||(this._subscriptions=this._createSubscriptionManager()),this._subscriptions},enumerable:!1,configurable:!0}),n.prototype._applyPendingSubscriptionListMutations=function(t,e){return pn(this,void 0,void 0,(function(){var n,r;return dn(this,(function(i){switch(i.label){case 0:return null==e?[3,1]:(r=e,[3,3]);case 1:return[4,this._storage.getPendingSubscriptionListMutations()];case 2:r=i.sent(),i.label=3;case 3:return(n=r).length?[4,this._client.updateSubscriptions(t,n)]:[3,7];case 4:return i.sent(),[4,this._storage.setPendingSubscriptionListMutations([])];case 5:return i.sent(),[4,this._storage.appendSubscriptionListMutations(t,n)];case 6:i.sent(),this._lifecycle.accept("contact",Date.now(),{contactId:t,type:"subscription_list_mutation",mutations:n,outcome:ee(n)}),i.label=7;case 7:return[2]}}))}))},n.prototype._registerAndAssociateChannel=function(t){return pn(this,void 0,void 0,(function(){var e,n,r;return dn(this,(function(i){switch(i.label){case 0:return[4,this._ready];case 1:return i.sent(),n=w,[4,this._locale()];case 2:return e=n.apply(void 0,[i.sent()]),[4,t(e)];case 3:return r=i.sent(),[2,this._associateChannel(r)]}}))}))},n.prototype._associateChannel=function(t){return pn(this,void 0,void 0,(function(){var e;return dn(this,(function(n){switch(n.label){case 0:return[4,this._storage.getOrCreateContactId()];case 1:return e=n.sent(),[4,this._client.associateChannel(e,t)];case 2:return n.sent(),[4,this._storage.appendAssociatedChannel(e,t)];case 3:return n.sent(),[4,this._applyPendingAttributeMutations(e)];case 4:return n.sent(),[4,this._applyPendingTagMutations(e)];case 5:return n.sent(),[4,this._applyPendingSubscriptionListMutations(e)];case 6:return n.sent(),[2]}}))}))},n.prototype.registerEmail=function(t,e){return pn(this,void 0,void 0,(function(){var n=this;return dn(this,(function(r){return[2,this._registerAndAssociateChannel((function(r){return pn(n,void 0,void 0,(function(){return dn(this,(function(n){switch(n.label){case 0:return[4,this._registration.registerEmail(t,fn(fn({},e),r))];case 1:return[2,{channelId:n.sent(),platform:"email"}]}}))}))}))]}))}))},n.prototype.registerSms=function(t,e){return pn(this,void 0,void 0,(function(){var n=this;return dn(this,(function(r){return[2,this._registerAndAssociateChannel((function(r){return pn(n,void 0,void 0,(function(){return dn(this,(function(n){switch(n.label){case 0:return[4,this._registration.registerSms(t,fn(fn({},e),r))];case 1:return[2,{channelId:n.sent(),platform:"sms"}]}}))}))}))]}))}))},n.prototype.registerOpen=function(t,e){return pn(this,void 0,void 0,(function(){var n=this;return dn(this,(function(r){return[2,this._registerAndAssociateChannel((function(r){return pn(n,void 0,void 0,(function(){return dn(this,(function(n){switch(n.label){case 0:return[4,this._registration.registerOpen(t,fn(fn({},e),r))];case 1:return[2,{channelId:n.sent(),platform:"open"}]}}))}))}))]}))}))},n.prototype.associateChannel=function(t,e){return pn(this,void 0,void 0,(function(){return dn(this,(function(n){switch(n.label){case 0:return[4,this._ready];case 1:if(n.sent(),r=t,!be.includes(r))throw new Vt("invalid platform: "+t);return[2,this._associateChannel({platform:t,channelId:e})]}var r}))}))},n.prototype._migrate=function(t,e){return pn(this,void 0,void 0,(function(){var n,r;return dn(this,(function(i){switch(i.label){case 0:return(n=null==t?void 0:t.named_user_id)?n===e?(u("contact: old nu matches new nu, no migration needed"),[2,!1]):[4,this._resolve(t.id,!0)]:(u("contact: no old nu, no migration needed"),[2,!1]);case 1:return r=hn.apply(void 0,[i.sent(),2]),r[1]?(u("contact: migration for existing user resolved to anonymous"),[2,!1]):[4,this._storage.setNamedUserId(n)];case 2:return i.sent(),[2,!0]}}))}))},n.prototype._resolve=function(t,e){return pn(this,void 0,void 0,(function(){var n,r,i,o,a,s,u;return dn(this,(function(c){switch(c.label){case 0:return[4,this._storage.getOrCreateContactId()];case 1:return n=c.sent(),[4,this._storage.getNamedUserId()];case 2:return r=c.sent(),(i=!e)?[4,this._storage.sessionResolved()]:[3,4];case 3:i=c.sent(),c.label=4;case 4:return i?[2,[n,!r]]:[4,this._client.resolve(t)];case 5:return o=hn.apply(void 0,[c.sent(),2]),a=o[0],s=o[1],[4,this._storage.setSessionResolved(!0)];case 6:return c.sent(),u=!r===s,n===a&&u?(this._lifecycle.accept("contact",Date.now(),{contactId:a,type:"resolve"}),[2,[a,s]]):[4,this._storage.setContactId(a)];case 7:return c.sent(),s?[4,this._storage.clearNamedUserId()]:[3,9];case 8:c.sent(),c.label=9;case 9:return[4,this._maybeEmitConflict(n,r)];case 10:return c.sent(),this._lifecycle.accept("contact",Date.now(),{contactId:a,type:"resolve"}),[2,[a,s]]}}))}))},n.prototype._doIdentify=function(t,e){return pn(this,void 0,void 0,(function(){var n,r;return dn(this,(function(i){switch(i.label){case 0:return[4,this._storage.getOrCreateContactId()];case 1:return n=i.sent(),[4,this._client.identify(t,e,{contactId:n})];case 2:return r=i.sent(),n===r?[3,4]:[4,this._maybeEmitConflict(n)];case 3:i.sent(),i.label=4;case 4:return[4,this._storage.setContactId(r)];case 5:return i.sent(),[4,this._storage.setNamedUserId(t)];case 6:return i.sent(),[4,this._storage.setSessionResolved(!0)];case 7:return i.sent(),[2,r]}}))}))},n.prototype._doReset=function(t){return pn(this,void 0,void 0,(function(){var e,n,r,i;return dn(this,(function(o){switch(o.label){case 0:return[4,this._storage.getOrCreateContactId()];case 1:return e=o.sent(),t?[4,this._client.reset(t)]:[3,3];case 2:return n=o.sent(),[3,5];case 3:return[4,this._storage.clearContactId()];case 4:n=o.sent(),o.label=5;case 5:return e===n?[3,8]:(r=this._maybeEmitConflict,i=[e],[4,this._storage.getNamedUserId()]);case 6:return[4,r.apply(this,i.concat([o.sent()]))];case 7:o.sent(),o.label=8;case 8:return[4,this._resetStoredContact(n)];case 9:return o.sent(),[2,n]}}))}))},n.prototype._onChannel=function(t){return pn(this,void 0,void 0,(function(){var e,n,r,i;return dn(this,(function(o){switch(o.label){case 0:return[4,this._ready];case 1:return o.sent(),(e=t.detail)?[4,this._isRelevantToAirship()]:[2];case 2:return o.sent()?[4,this._resolve(e.id)]:[2];case 3:return n=hn.apply(void 0,[o.sent(),1]),r=n[0],[4,this._applyPendingAttributeMutations(r)];case 4:return o.sent(),[4,this._applyPendingTagMutations(r)];case 5:return o.sent(),[4,this._applyPendingSubscriptionListMutations(r)];case 6:return o.sent(),i=new CustomEvent("_channel_handled"),this.dispatchEvent(i),[2]}}))}))},n.prototype._maybeEmitConflict=function(t,e){return pn(this,void 0,void 0,(function(){var n,r,i,o,a,s;return dn(this,(function(u){switch(u.label){case 0:return[4,this._storage.getAttributeMutations(t)];case 1:return n=u.sent(),[4,this._storage.getTagMutations(t)];case 2:return r=u.sent(),[4,this._storage.getAssociatedChannels(t)];case 3:return i=u.sent(),[4,this._storage.getSubscriptionListMutations(t)];case 4:return o=u.sent(),e||n.length||r.length||i.length||o.length?(a={namedUserId:e,attributes:Pt(n),tags:xt(r),subscriptions:Xt(o),associatedChannels:i},s=new CustomEvent("conflict",{detail:a}),this.dispatchEvent(s),[2]):[2]}}))}))},Object.defineProperty(n.prototype,"ready",{get:function(){return this._ready},enumerable:!1,configurable:!0}),n.prototype._isRelevantToAirship=function(){return pn(this,void 0,void 0,(function(){var t,e,n;return dn(this,(function(r){switch(r.label){case 0:return[4,this._channel()];case 1:return t=r.sent(),[4,this._storage.getOrCreateContactId()];case 2:return e=r.sent(),[4,this._storage.getAssociatedChannels(e)];case 3:return n=r.sent(),[2,!!t||!!n.length]}}))}))},n.prototype._nonCanonicalChannelId=function(){var t;return pn(this,void 0,void 0,(function(){var e,n,r;return dn(this,(function(i){switch(i.label){case 0:return[4,this._channel()];case 1:return(e=i.sent())?[2,e.id]:[4,this._storage.getOrCreateContactId()];case 2:return n=i.sent(),[4,this._storage.getAssociatedChannels(n)];case 3:return r=i.sent(),[2,null===(t=r[0])||void 0===t?void 0:t.channelId]}}))}))},n.prototype._resetStoredContact=function(t){return pn(this,void 0,void 0,(function(){return dn(this,(function(e){switch(e.label){case 0:return[4,this._storage.setContactId(t)];case 1:return e.sent(),[4,this._storage.clearNamedUserId()];case 2:return e.sent(),[4,this._storage.setPendingAttributeMutations([])];case 3:return e.sent(),[4,this._storage.setPendingTagMutations([])];case 4:return e.sent(),[2]}}))}))},n}(e.EventTarget);function yn(t,e,n,r,i,o){var a=new Qe({prefix:t.storagePrefix,sessionLengthMs:t.contacts.sessionLengthMs,namedUserTtlMs:t.contacts.namedUserTtlMs,_forceExpireNamedUsers:t.contacts._forceExpireNamedUsers},d,self.sessionStorage),s=function(t,e){var n=new xe(t,e),r=new R({prefix:t.storagePrefix,ttlMs:t.cacheTtlMs},self.sessionStorage),i=new B(r),o=new L({indexKey:"contact",keyFn:function(t){return t.listId+":"+t.scope}},r);return new Pe(n,i,o)}({paths:t.paths.contact,storagePrefix:t.storagePrefix,cacheTtlMs:t.subscriptionLists.cacheTtlMs},X(t)),u=new Ae({paths:t.paths.contact.registration},X(t));return new vn(e,n,a,s,u,r,i,o)}function bn(){return window.location}var gn=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};var mn=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},wn=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},_n=n(953),Sn=function(){function t(t,e,n,r){if(void 0===n&&(n={}),!t)throw new ReferenceError("argument: `name` is required.");var i=this.getChannel();if(!i)throw new ReferenceError("You must have a registered channel to send events.");this._channel=i,this._name=t,this.value=e,this.properties=n,this.transactionId=r,this.interactionId=bn().href,this.interactionType="url"}return Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(t){if(t&&(t=Number(t),Number.isNaN(t)||"number"!=typeof t))throw new TypeError("`value` must be a number");this._value=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),t.prototype._prepareProperties=function(){return this.properties},t.prototype._prepareInteractionId=function(){return mn(this,void 0,void 0,(function(){var t,e,n;return wn(this,(function(r){switch(r.label){case 0:return this.interactionId===bn().href&&this.interactionId.length<=255?[2,!1]:(t=new window.TextEncoder("utf-8").encode(this.interactionId),[4,window.crypto.subtle.digest("SHA-256",t)]);case 1:return e=r.sent(),n=Array.from(new Uint8Array(e)).map((function(t){return("0"+t.toString(16)).slice(-2)})).join(""),this.interactionId=this.interactionId.slice(0,230)+"..."+n.slice(0,20),[2,!0]}}))}))},t.prototype.validate=function(){var t=this._prepareProperties();this._validateProperties(t);!function(t,e,n){var r,i;void 0===n&&(n="CustomEvent");try{for(var o=gn(e),a=o.next();!a.done;a=o.next()){var s=a.value,u=t[s];if(void 0===u)return;if("string"!=typeof u)throw new TypeError(n+"."+s+" must be a string");if("string"==typeof u&&u.length>255)throw new RangeError(n+"."+s+" has a 255 character limit")}}catch(t){r={error:t}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}}(this,["name","transactionId","interactionId","interactionId"])},t.prototype._validateProperties=function(t){if(Array.isArray(t)||"object"!=typeof t)throw new TypeError("CustomEvent: properties must be an object");var e;try{e=JSON.stringify(t)}catch(t){throw new TypeError("CustomEvent: properties must be JSON serializable.")}if(e.length>32768)throw new RangeError("CustomEvent: properties are "+e.length+" when JSON encoded, exceeding the maximum of 32768.")},t.prototype._validateBooleanProperty=function(t){if(this.properties&&this.properties.hasOwnProperty(t)&&"boolean"!=typeof this.properties[t])throw new TypeError("CustomEvent property '"+t+"' must be a Boolean")},t.prototype._validateIsoDateProperty=function(t){if(this.properties&&this.properties.hasOwnProperty(t)&&!_n(this.properties[t]))throw new TypeError("CustomEvent property '"+t+"' must be an ISO_8601 date string")},t.prototype.toJSON=function(){var t=this.getSession(),e={web_channel:this._channel.id},n=(new Date).toISOString().split(".")[0]+"Z",r=null==t?void 0:t.send_id,i=this._prepareProperties();return{occurred:n,user:e,send_id:r,body:{name:this.name,value:this.value,transaction:this.transactionId,interaction_id:this.interactionId,interaction_type:this.interactionType,template_type:this.templateType,session_id:null==t?void 0:t.id,properties:Object.keys(i).length?i:void 0}}},t.prototype.track=function(){return mn(this,void 0,void 0,(function(){return wn(this,(function(t){switch(t.label){case 0:return[4,this.reportable()];case 1:return t.sent()?[4,this._prepareInteractionId()]:[2,{ok:!1,message:"Channel is not opted in or analytics/data-collection are disabled."}];case 2:return t.sent(),this.validate(),[2,this.sendEvent()]}}))}))},t}(),Pn=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),xn=function(t){function e(e,n,r){void 0===n&&(n={});var i=t.call(this,"registered_account",e,n,r)||this;return i.templateType="account",i}return Pn(e,t),e.prototype._prepareProperties=function(){return this.value&&(this.properties.ltv=!0),t.prototype._prepareProperties.call(this)},e}(Sn),En=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),On=function(t){function e(e,n,r,i){void 0===r&&(r={});var o=t.call(this,e,n,r,i)||this;return o.templateType="media",o}return En(e,t),e.prototype.validate=function(){this._validateBooleanProperty("feature"),this._validateIsoDateProperty("published_date"),t.prototype.validate.call(this)},e.prototype._prepareProperties=function(){return this.value&&(this.properties.ltv=!0),t.prototype._prepareProperties.call(this)},e}(Sn),Mn=function(t){function e(e,n,r){return void 0===n&&(n={}),t.call(this,"browsed_content",e,n,r)||this}return En(e,t),e}(On),kn=function(t){function e(e,n,r){return void 0===n&&(n={}),t.call(this,"consumed_content",e,n,r)||this}return En(e,t),e}(On),An=function(t){function e(e,n,r){return void 0===n&&(n={}),t.call(this,"starred_content",e,n,r)||this}return En(e,t),e}(On),Tn=function(t){function e(e,n,r,i){void 0===r&&(r={});var o=t.call(this,"shared_content",void 0,r,i)||this;return o.properties.source=e,o.properties.medium=n,o}return En(e,t),e}(On),Cn=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),In=function(t){function e(e,n,r,i){void 0===r&&(r={});var o=t.call(this,e,n,r,i)||this;return o.templateType="retail",o}return Cn(e,t),e.prototype.validate=function(){this._validateBooleanProperty("new_item"),t.prototype.validate.call(this)},e}(Sn),jn=function(t){function e(e,n,r){return void 0===n&&(n={}),t.call(this,"browsed",e,n,r)||this}return Cn(e,t),e}(In),Nn=function(t){function e(e,n,r){return void 0===n&&(n={}),t.call(this,"added_to_cart",e,n,r)||this}return Cn(e,t),e}(In),Rn=function(t){function e(e,n,r){return void 0===n&&(n={}),t.call(this,"purchased",e,n,r)||this}return Cn(e,t),e.prototype._prepareProperties=function(){return this.value&&(this.properties.ltv=!0),t.prototype._prepareProperties.call(this)},e}(In),Bn=function(t){function e(e,n,r){return void 0===n&&(n={}),t.call(this,"starred_product",e,n,r)||this}return Cn(e,t),e}(In),Ln=function(t){function e(e,n,r,i){void 0===r&&(r={});var o=t.call(this,"shared_product",void 0,r,i)||this;return o.properties.source=e,o.properties.medium=n,o}return Cn(e,t),e}(In),Un=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();var Dn=36e5;function Fn(t,e){if(void 0===t&&(t={}),void 0===e&&(e=!1),o.configured)return o;delete t.paths,delete t.consts,Object.assign(o,t);var n=new URL(o.workerUrl,o.workerUrl.startsWith("/")?self.location.href:void 0);o.deprecatedStoragePrefix=self.btoa(o.storagePrefix+":"+o.appKey+":"+o.workerUrl);var r=n.pathname.replace(/[^/]+$/,"");if(o.storagePrefix=self.btoa(o.storagePrefix+":"+o.appKey+":"+r),o.secureBridgeUrl=function(t){return t.secureIframeUrl||t.secureBridgeUrl?t.secureIframeUrl||t.secureBridgeUrl:t.registrationDomain&&t.secureBridgePath?new URL(t.secureBridgePath,"https://"+t.registrationDomain).href:null}(o),o.registrationDomain?o.secureHost="https://"+o.registrationDomain:o.secureBridgeUrl&&(o.secureHost=new URL(o.secureBridgeUrl).origin),o.debug){var a=e?"secure-bridge":"main";console.log("UA[%s] configured with:",a,o)}return o.contacts.namedUserTtlMs=Math.max(Dn,o.contacts.namedUserTtlMs),"string"!=typeof o.appVersion&&(console.error("invalid app version "+o.appVersion+" specified; resetting to default"),o.appVersion=i),o.configured=!0,o}function qn(t,e){t="last_"+t;var n=+new Date,r=et.getJSON(t);return{store:function(){return et.setJSON(t,n)},after:!r||n-r>36e5*e}}var Gn=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Vn=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Kn=2e4;function Wn(t){return void 0===t&&(t=Date.now()),Gn(this,void 0,void 0,(function(){var e;return Vn(this,(function(n){switch(n.label){case 0:return[4,d.get("last_send_id")];case 1:return(e=n.sent())&&t-e.timestamp<=Kn?[4,d.remove("last_send_id")]:[3,3];case 2:return n.sent(),[2,e.id];case 3:return[2]}}))}))}var Jn=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},zn=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};function Hn(t,e){return Jn(this,void 0,void 0,(function(){var n;return zn(this,(function(r){switch(r.label){case 0:return e?[2,Qn(t,e)]:[4,Zn()];case 1:return(n=r.sent())?[2,Qn(t,n)]:[2,!1]}}))}))}function Qn(t,e){return Jn(this,void 0,void 0,(function(){var n;return zn(this,(function(r){switch(r.label){case 0:return[4,Yn(t.optedIn)];case 1:if(!r.sent())return[2,!1];n={session_id:e.id,send_id:e.send_id,channel:t.toJSON()},et.setJSON("session",e),r.label=2;case 2:return r.trys.push([2,4,,5]),[4,U(o.paths.reports.session,{method:"post",body:n})];case 3:return[2,r.sent().ok];case 4:return r.sent(),[2,!1];case 5:return[2]}}))}))}function Zn(){return Jn(this,void 0,void 0,(function(){var t,e,n;return zn(this,(function(r){switch(r.label){case 0:return t=qn("activity",.5),e=t.after,(0,t.store)(),[4,Wn()];case 1:return(n=r.sent())||e?[2,{id:(0,Ie.v4)(),send_id:n}]:[2]}}))}))}function Yn(t){return Jn(this,void 0,void 0,(function(){return zn(this,(function(e){switch(e.label){case 0:return o.disableAnalytics?[2,!1]:[4,d.get(o.consts.DISABLE_ANALYTICS)];case 1:return e.sent()?[2,!1]:t||o.trackEventsForOptOutChannels?[2,M()]:[2,!1]}}))}))}function Xn(t,e){var n=t.data[o.storagePrefix];return"*"!==e&&t.origin!==e||!n?{}:n}function $n(t){var e;return(e={})[o.storagePrefix]=t,e}var tr=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};function er(t){t.tags&&(u("[secure-bridge] Setting channel tags from message data: %o",t.tags),et.setJSON("tags",t.tags)),t.channel&&(u("[secure-bridge] Setting channel data from message data: %o",t.channel),d.set("channel",t.channel)),t.subscriptionDomain&&(u("[secure-bridge] Setting subscriptionDomain from message data: %s",t.subscriptionDomain),d.set("subscriptionDomain",t.subscriptionDomain))}var nr=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},rr=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},ir=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},or=function(){function t(){this.plugins=new Map,this.loaders=new Map}return Object.defineProperty(t.prototype,"list",{get:function(){var t,e,n=[];try{for(var r=ir(this.plugins.keys()),i=r.next();!i.done;i=r.next()){var o=i.value;n.push(o)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return n},enumerable:!1,configurable:!0}),t.prototype.load=function(t,e,n){var r=this,i=this.loaders.get(t);if(i)return i;var o=new Promise((function(i){var o={url:e,opts:n,setLoaded:function(t){i(t)}};r.plugins.set(t,o)}));this.loaders.set(t,o);var a=function(t,e,n){void 0===n&&(n=document);var r=n.createElement("script");return r.src=e,r.async=!0,r.setAttribute("rel",t),n.head.appendChild(r),r}(t,e);return a.addEventListener("error",(function(){throw r.loaders.delete(t),new Error("Error while loading plugin at URL: '"+e+"'")})),o},t.prototype._setLoaded=function(t,e,n){var r=this.plugins.get(t);if(!r)throw new Error("Airship Plugin "+t+" does not match any currently loading plugins: "+this.list.join(", "));return r.setLoaded(e(r.opts,n))},t.prototype.get=function(t){return nr(this,void 0,void 0,(function(){var e;return rr(this,(function(n){if(e=this.loaders.get(t))return[2,e];throw new Error("The plugin '"+t+"' is not loaded. Make sure you have called plugins.load(...) correctly.")}))}))},t}(),ar=or;function sr(t){return void 0===t&&(t=self),!("PushManager"in t)&&!!("safari"in t||navigator.userAgent.match(/Safari/)&&!navigator.userAgent.match(/Chrome/))}function ur(t,e){return e.push_address=t.endpoint,e.web.subscription=t.toJSON().keys,{channel:e}}var cr=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},lr=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};function fr(t){return cr(this,void 0,void 0,(function(){var e,n,r;return lr(this,(function(i){switch(i.label){case 0:return"string"!=typeof(e=o.vapidPublicKey)?[2,Promise.reject("vapidPublicKey not configured")]:(n=function(t){var e;try{e=window}catch(t){e=self}for(var n=(t+"=".repeat((4-t.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),r=e.atob(n),i=new Uint8Array(r.length),o=0;o<r.length;++o)i[o]=r.charCodeAt(o);return i}(e),[4,t.pushManager.getSubscription()]);case 1:return(r=i.sent())?(a=new Uint8Array(r.options.applicationServerKey),s=n,a.length===s.length&&a.every((function(t,e){return t===s[e]}))?[2,r]:[4,r.unsubscribe()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[2,pr(t,n)]}var a,s}))}))}function pr(t,e){return t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:e})}function dr(t,e){if((sr()||function(t){return void 0===t&&(t=self),!(!("safari"in t)||!o.websitePushId)&&"granted"===t.safari.pushNotification.permission(o.websitePushId).permission}())&&e)return(n=o.websitePushId,"string"!=typeof n?Promise.reject("No websitePushId configured."):new Promise((function(t,e){window.safari.pushNotification.requestPermission(new window.URL(o.appKey+"/",o.safariServiceUrl).href,n,{},(function(n){if("granted"===n.permission)return t(n);e("Registration failed: permission denied.\nYou may want to check that '"+bn().host+"' is one of your allowed domains.")}))}))).then((function(t){return b.fromStorage().then((function(n){var r,i,o=P({optedIn:e,localeOverride:n});return r=t,(i=o).push_address="granted"===r.permission?r.deviceToken:void 0,i.web.subscription={subscription_type:"apns"},{channel:i}}))}));if(sr())return b.fromStorage().then((function(t){return{channel:P({optedIn:!1,localeOverride:t})}}));var n,r;return t&&e?(r=t,Notification.requestPermission().then((function(t){if("granted"===t)return r;throw new Error("Notification permission is denied.")}))).then(fr).then((function(t){return b.fromStorage().then((function(e){var n=P({optedIn:!0,localeOverride:e});return ur(t,n)}))})):t?b.fromStorage().then((function(t){return{channel:P({optedIn:!1,localeOverride:t})}})):Promise.reject("Worker registration failed")}var hr=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},vr=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};function yr(t){return"preference_forms"===t.type}function br(t){return"in_app_messages"===t.type}var gr=Object(),mr=function(){function t(t,e){this._config=t,this._request=e}return t.prototype.get=function(t){var e=t.locale,n=t.ifModifiedSince;return hr(this,void 0,void 0,(function(){var t,r,i,o,a,s,u,c,l;return vr(this,(function(f){switch(f.label){case 0:t=this._config,r=t.paths,i=t.sdkVersion,o=t.appKey,a=r.app+"/"+o+"/web/",s={sdk_version:i},(null==e?void 0:e.language)&&(null==e?void 0:e.country)&&(s.language=e.language,s.country=e.country),u={},n&&(u["If-Modified-Since"]=new Date(n).toUTCString()),f.label=1;case 1:return f.trys.push([1,3,,4]),[4,this._request.get(a,{queryParams:s,headers:u,cache:"reload"})];case 2:return c=f.sent(),[3,4];case 3:if((l=f.sent())instanceof V&&304===l.statusCode)return[2,gr];throw l;case 4:if(!c.ok)throw new Error("unexpected response");return[2,c.payloads]}}))}))},t}(),wr=mr,_r=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Sr=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Pr=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},xr=function(){function t(t,e,n){this._client=t,this._locale=e,this._cache=n}return t.prototype.get=function(){return _r(this,void 0,void 0,(function(){var t,e=this;return Sr(this,(function(n){switch(n.label){case 0:return[4,this._locale()];case 1:return t=n.sent(),[2,this._cache.get(this._cacheKey(t),(function(n){return _r(e,void 0,void 0,(function(){var e;return Sr(this,(function(r){switch(r.label){case 0:return[4,this._client.get({locale:t,ifModifiedSince:n})];case 1:return(e=r.sent())===gr?[2,N]:[2,e]}}))}))}))]}}))}))},t.prototype._cacheKey=function(t){var e,n;return"remote_data:"+[null!==(e=t.language)&&void 0!==e?e:"default",null!==(n=t.country)&&void 0!==n?n:"default"].join("-")},t}(),Er=xr,Or=function(){function t(t){this._remote=t}return t.prototype.get=function(t){return _r(this,void 0,void 0,(function(){var e,n,r,i,o,a;return Sr(this,(function(s){switch(s.label){case 0:return[4,this.list()];case 1:e=s.sent();try{for(n=Pr(e),r=n.next();!r.done;r=n.next())if((i=r.value).id===t)return[2,i]}catch(t){o={error:t}}finally{try{r&&!r.done&&(a=n.return)&&a.call(n)}finally{if(o)throw o.error}}return[2,null]}}))}))},t.prototype.list=function(){return _r(this,void 0,void 0,(function(){var t,e;return Sr(this,(function(n){switch(n.label){case 0:return[4,this._remote.get()];case 1:return t=n.sent(),e=[],t.filter(yr).forEach((function(t){t.data.preference_forms.forEach((function(t){return e.push(t.form)}))})),[2,e]}}))}))},t}();!function(){function t(t){this._remote=t}t.prototype.list=function(){return _r(this,void 0,void 0,(function(){return Sr(this,(function(t){switch(t.label){case 0:return[4,this._remote.get()];case 1:return[2,t.sent().filter(br).reduce((function(t,e){return t.concat(e.data.in_app_messages)}),[])]}}))}))}}();function Mr(){return!("standalone"in navigator)||!("ontouchstart"in window)||navigator.standalone}function kr(){var t=window.location.hostname;return!o.registrationDomain||t===o.registrationDomain}function Ar(){var t=window.isSecureContext;return void 0!==t?t:Boolean(bn().protocol.match("https"))}var Tr=["indexedDB","localStorage","fetch","crypto"];function Cr(){var t=Tr.every((function(t){return t in window}));return o.loadIfPushNotSupported?t:t&&Ir()}function Ir(){var t=navigator.userAgent.match(/Chrome\/(\d\d)\./);return!(t&&Number(t[1])<52)&&Boolean("PushManager"in window||sr()&&o.websitePushId&&"safari"in window&&"pushNotification"in window.safari)}var jr=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Nr=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};function Rr(){return jr(this,void 0,void 0,(function(){var t;return Nr(this,(function(e){switch(e.label){case 0:return o.deprecatedStoragePrefix?[4,d.count()]:[2,!1];case 1:return e.sent()?[2,!1]:(t=p((function(){return o.deprecatedStoragePrefix+":db"}),"blob",{keyPath:"type"},(function(t){var e;return null===(e=t.target.result)||void 0===e?void 0:e.value}),1),[4,t.copy(d)]);case 2:return e.sent(),[2,!0]}}))}))}var Br=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))};var Lr=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Ur=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};function Dr(){var t,e;return Lr(this,void 0,void 0,(function(){var n,r;return Ur(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,null===(t=null===navigator||void 0===navigator?void 0:navigator.permissions)||void 0===t?void 0:t.query({name:"notifications"})];case 1:return n=null===(e=i.sent())||void 0===e?void 0:e.state,r="default"===Notification.permission?"prompt":Notification.permission,"denied"===n||"denied"===r?[2,"denied"]:"granted"===n||"granted"===r?[2,"granted"]:"prompt"===n&&"prompt"===r?[2,"prompt"]:[3,3];case 2:return i.sent(),[2,void 0];case 3:return[2]}}))}))}var Fr=["activating","activated"];function qr(t){return new Promise((function(e,n){t.active&&e(t);var r=t.installing||t.waiting;r?r.addEventListener("statechange",(function(){Fr.includes(r.state)&&e(t)})):n("Service worker in an unknown state")}))}var Gr="install_date";function Vr(){var t;null!==(t=et.getJSON(Gr))&&void 0!==t&&t||et.setJSON(Gr,Date.now())}var Kr=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Wr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Kr(e,t),e.prototype.accept=function(t,e,n){var r=new CustomEvent(t,{detail:{timestamp:e,payload:n}});this.dispatchEvent(r)},e}(e.EventTarget),Jr=Wr;var zr=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Hr=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Qr=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Zr=function(e){function n(){var n,r,i,a,s=e.call(this)||this;s.dataCollectionEnabledSync=!0,s._registrationMutex=new t.Z,s._isSetup=new Br,s._channelPromise=new Promise((function(t){s.addEventListener("channel",(function(e){return t(e.detail)}),{once:!0})})),s._workerRegistration=!sr()&&navigator.serviceWorker?navigator.serviceWorker.register(o.workerUrl).then(qr):Promise.reject("Worker registration not available in this context"),s._workerRegistration.catch((function(t){return u("SW Registration Error",t)})),s._channelPromise.then(s.heartbeat.bind(s)),s._channelPromise.then(s.checkPermission.bind(s)),s.isSupported=Cr(),s.isWebPushSupported=Ir(),s.canRegister=Boolean(Ir()&&Ar()&&kr()&&Mr()&&"denied"!==Notification.permission),s.isRegistrationDomain=kr(),s.gestureRequired=(r=g.parse(navigator.userAgent).browser,i=(null===(n=r.name)||void 0===n?void 0:n.toLowerCase())||"",a=(null==r?void 0:r.version)?parseFloat(r.version):0,i.includes("safari")&&a>=12.1||i.includes("firefox")&&a>=72),s.isAllowedPushRegistrationContext=Mr(),s.setDataCollectionEnabled=function(t){return k(t,s)},s.isDataCollectionEnabled=M,s._lifecycleEvents=new Jr,o.secureBridgeUrl&&o.secureBridgeUrl.match(/accengage\.net/)&&!o.mixedRegistrationDomains&&console.warn("WARNING: you should set 'mixedRegistrationDomains' to true if you are migrating from Accengage and were using an Accengage-owned domain"),u("[main] Web SDK environment:");var c={isSecure:Ar(),isRegistrationDomain:s.isRegistrationDomain,mixedRegistrationDomains:o.mixedRegistrationDomains,secureBridgeUrl:o.secureBridgeUrl,allowedDomains:o.allowedDomains};o.secureBridgeUrl&&(c.sbOriginDifferentFromCurrent=new URL(o.secureBridgeUrl).origin!==window.location.origin),u(c);var l,f=(!Ar()||!s.isRegistrationDomain||o.mixedRegistrationDomains)&&o.secureBridgeUrl&&new URL(o.secureBridgeUrl).origin!==window.location.origin&&!sr();if(f&&!o.secureBridgeUrl&&console.warn("Airship SDK is integrated on a non-secured domain but 'secureIframeUrl' is not provided."),s.hasExistingSubscription=Promise.resolve(),f&&o.secureBridgeUrl){if(function(t,e){u("Setting up secure-bridge with %s",e);var n=o.secureHost,r=document.createElement("iframe"),i=new Promise((function(t){r.onload=function(){return t(r)}})),a=new URL(e);function s(t){i.then((function(e){var r;u("[main] Sending data to secure-bridge (%s): %o",n,t),null===(r=e.contentWindow)||void 0===r||r.postMessage($n(t),n)}))}a.searchParams.append("__ua_secondary_origin",bn().origin),r.style.display="none",r.src=a.toString(),document.body.appendChild(r),window.addEventListener("message",(function(e){var r=Xn(e,n);t._set(r)})),t.addEventListener("tags",(function(t){s({tags:t.tags})})),t.addEventListener("channel",(function(){d.get("channel").then((function(t){s({channel:t})}))})),t.addEventListener("subscriptiondomain",(function(t){s({subscriptionDomain:t.detail})}))}(s,o.secureBridgeUrl),o.mixedRegistrationDomains){var p=new Promise((function(t){s.addEventListener("subscriptiondomain",(function(e){return t(e.detail)}),{once:!0})}));s.hasExistingSubscription=Promise.race([p,(l=1e3,new Promise((function(t){setTimeout(t,l)})))])}}else s._channelPromise.then((function(t){return Hn(t)}));return s.channel=null,s.localeOverride=new b,s.CustomEvent=function(t,e,n,r){var i,o;return i=function(i){function o(){return null!==i&&i.apply(this,arguments)||this}return Un(o,i),o.prototype.getChannel=function(){return t()},o.prototype.getSession=function(){return e()},o.prototype.reportable=function(){return n()},o.prototype.sendEvent=function(){return r(this)},o}(Sn),i.templates={retail:{AddedToCartEvent:function(i){function o(){return null!==i&&i.apply(this,arguments)||this}return Un(o,i),o.prototype.getChannel=function(){return t()},o.prototype.getSession=function(){return e()},o.prototype.reportable=function(){return n()},o.prototype.sendEvent=function(){return r(this)},o}(Nn),BrowsedEvent:function(i){function o(){return null!==i&&i.apply(this,arguments)||this}return Un(o,i),o.prototype.getChannel=function(){return t()},o.prototype.getSession=function(){return e()},o.prototype.reportable=function(){return n()},o.prototype.sendEvent=function(){return r(this)},o}(jn),PurchasedEvent:function(i){function o(){return null!==i&&i.apply(this,arguments)||this}return Un(o,i),o.prototype.getChannel=function(){return t()},o.prototype.getSession=function(){return e()},o.prototype.reportable=function(){return n()},o.prototype.sendEvent=function(){return r(this)},o}(Rn),SharedProductEvent:function(i){function o(){return null!==i&&i.apply(this,arguments)||this}return Un(o,i),o.prototype.getChannel=function(){return t()},o.prototype.getSession=function(){return e()},o.prototype.reportable=function(){return n()},o.prototype.sendEvent=function(){return r(this)},o}(Ln),StarredProductEvent:function(i){function o(){return null!==i&&i.apply(this,arguments)||this}return Un(o,i),o.prototype.getChannel=function(){return t()},o.prototype.getSession=function(){return e()},o.prototype.reportable=function(){return n()},o.prototype.sendEvent=function(){return r(this)},o}(Bn)},media:{BrowsedContentEvent:function(i){function o(){return null!==i&&i.apply(this,arguments)||this}return Un(o,i),o.prototype.getChannel=function(){return t()},o.prototype.getSession=function(){return e()},o.prototype.reportable=function(){return n()},o.prototype.sendEvent=function(){return r(this)},o}(Mn),ConsumedContentEvent:function(i){function o(){return null!==i&&i.apply(this,arguments)||this}return Un(o,i),o.prototype.getChannel=function(){return t()},o.prototype.getSession=function(){return e()},o.prototype.reportable=function(){return n()},o.prototype.sendEvent=function(){return r(this)},o}(kn),SharedContentEvent:function(i){function o(){return null!==i&&i.apply(this,arguments)||this}return Un(o,i),o.prototype.getChannel=function(){return t()},o.prototype.getSession=function(){return e()},o.prototype.reportable=function(){return n()},o.prototype.sendEvent=function(){return r(this)},o}(Tn),StarredContentEvent:function(i){function o(){return null!==i&&i.apply(this,arguments)||this}return Un(o,i),o.prototype.getChannel=function(){return t()},o.prototype.getSession=function(){return e()},o.prototype.reportable=function(){return n()},o.prototype.sendEvent=function(){return r(this)},o}(An)},account:(o=function(i){function o(){return null!==i&&i.apply(this,arguments)||this}return Un(o,i),o.prototype.getChannel=function(){return t()},o.prototype.getSession=function(){return e()},o.prototype.reportable=function(){return n()},o.prototype.sendEvent=function(){return r(this)},o}(xn),o.RegisterEvent=o,o)},i}((function(){return s.channel}),(function(){return et.getJSON("session")}),(function(){var t,e;return Yn(null!==(e=null===(t=s.channel)||void 0===t?void 0:t.optedIn)&&void 0!==e&&e)}),(function(t){return s.sendCustomEvent(t)})),s.plugins=new ar,s._contactPromise=s.createContact(),window.addEventListener("storage",et.onStorage((function(t){return s._set(t)}))),navigator.serviceWorker&&navigator.serviceWorker.addEventListener("message",(function(t){"push"===t.data.type&&(u("Push event from worker",t),s.dispatchEvent({type:"push",push:t.data.push}))})),s}return zr(n,e),n.prototype.sendCustomEvent=function(t){return Hr(this,void 0,void 0,(function(){var e,n;return Qr(this,(function(r){switch(r.label){case 0:return e=t.toJSON(),[4,U(o.paths.custom_events,{method:"post",body:e})];case 1:return 200===(n=r.sent()).status&&this._lifecycleEvents.accept("custom_event",new Date(e.occurred).getTime(),{name:t.name,properties:t.properties,value:t.value}),[2,n.json()]}}))}))},n.prototype.createContact=function(){return Hr(this,void 0,void 0,(function(){var t=this;return Qr(this,(function(e){switch(e.label){case 0:return[4,this._isSetup.promise];case 1:return e.sent(),[2,yn(o,(function(){return Hr(t,void 0,void 0,(function(){return Qr(this,(function(t){return[2,this.channel]}))}))}),(function(){return Hr(t,void 0,void 0,(function(){return Qr(this,(function(t){return[2,this.localeOverride]}))}))}),{isDataCollectionEnabled:this.isDataCollectionEnabled},this._lifecycleEvents,this)]}}))}))},n.prototype.checkDataCollection=function(){var t=this;return Promise.resolve(this.dataCollectionEnabled).then((function(e){t.dataCollectionEnabledSync=e}))},n.prototype.checkPermission=function(t){return Hr(this,void 0,void 0,(function(){var e;return Qr(this,(function(n){switch(n.label){case 0:return o.mixedRegistrationDomains?[4,this.hasExistingSubscription]:[3,2];case 1:if(n.sent())return[2];n.label=2;case 2:return[4,this.getNotificationPermission()];case 3:return(e=n.sent())&&"granted"!==e&&t.optedIn&&this.isRegistrationDomain&&t.optOut(),[2]}}))}))},n.prototype.heartbeat=function(t){var e=qn("heartbeat",24),n=e.after,r=e.store;n&&(u("SENDING heartbeat"),r(),t.optedIn&&this.isRegistrationDomain?this.register().catch((function(){return t.update()})):t.update())},n.prototype.getChannel=function(){return this._channelPromise},n.prototype._legacySetup=function(){try{var t=et.getJSON("channel");(null==t?void 0:t.channel_id)&&this._setChannel(t),this._isSetup.resolve()}catch(t){throw this._isSetup.reject(t),t}},n.prototype._setup=function(){return Hr(this,void 0,void 0,(function(){var t,e=this;return Qr(this,(function(n){switch(n.label){case 0:return[4,Rr()];case 1:return n.sent(),(t=[]).push(d.get("channel").then((function(t){t&&t.channel_id&&e._setChannel(t)})).then((function(){return b.getStoredLocale().then((function(t){e.localeOverride.set(t),e.channel&&e.localeOverride.setChannel(e.channel)}))}))),t.push(d.get("subscriptionDomain").then((function(t){t&&e._setSubscriptionDomain(t)}))),t.push(this.checkDataCollection()),[2,Promise.all(t).then((function(){return e._isSetup.resolve()})).catch((function(t){throw e._isSetup.reject(t),t}))]}}))}))},Object.defineProperty(n.prototype,"disableAnalytics",{get:function(){return d.get(o.consts.DISABLE_ANALYTICS).then((function(t){return!!t}))},set:function(t){d.set(o.consts.DISABLE_ANALYTICS,!!t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"dataCollectionEnabled",{get:function(){return M()},set:function(t){k(!!t,this),this.dataCollectionEnabledSync=!!t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"permission",{get:function(){var t;if(Ar())return null===(t=window.Notification)||void 0===t?void 0:t.permission},enumerable:!1,configurable:!0}),n.prototype.getNotificationPermission=function(){return Hr(this,void 0,void 0,(function(){return Qr(this,(function(t){switch(t.label){case 0:return[4,Dr()];case 1:return[2,t.sent()]}}))}))},Object.defineProperty(n.prototype,"contact",{get:function(){return this._contactPromise},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"lifecycleEvents",{get:function(){return this._lifecycleEvents},enumerable:!1,configurable:!0}),n.prototype.register=function(){return Hr(this,void 0,void 0,(function(){var t=this;return Qr(this,(function(e){return[2,this._registrationMutex.acquireAsync().then((function(){return t._register(!0)})).finally((function(){return t._registrationMutex.release()}))]}))}))},n.prototype.create=function(){return Hr(this,void 0,void 0,(function(){var t=this;return Qr(this,(function(e){return[2,this._registrationMutex.acquireAsync().then((function(){var e,n;return t._register(null!==(n=null===(e=t.channel)||void 0===e?void 0:e.optedIn)&&void 0!==n&&n)})).finally((function(){return t._registrationMutex.release()}))]}))}))},n.prototype._register=function(t){return Hr(this,void 0,void 0,(function(){var e,n,r,i,a;return Qr(this,(function(s){switch(s.label){case 0:if(!sr()){if(!Ar())return[2,Promise.reject("Registration not possible on a non-secure context.")];if(!this.isRegistrationDomain)return[2,Promise.reject("Domain is not allowed for registration.")]}if(t&&!this.isAllowedPushRegistrationContext)return[2,Promise.reject("Registration cannot happen in this context.")];if(!this.dataCollectionEnabledSync)return[2,Promise.reject("Data collection is disabled. Cannot register user.")];if(!this.isWebPushSupported)return[2,Promise.reject("Web push not supported in browser")];e=null,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this._workerRegistration];case 2:return e=s.sent(),[3,4];case 3:return s.sent(),[3,4];case 4:return[4,this.hasExistingSubscription];case 5:return(n=s.sent())&&n!==bn().hostname?[2,Promise.reject("An existing registration exists on "+n)]:[4,dr(e,t)];case 6:return r=s.sent(),this.channel?[4,U(this.channel.path,{method:"put",body:r})]:[3,8];case 7:return i=s.sent(),[3,10];case 8:return[4,U(o.paths.cra,{method:"post",body:r})];case 9:i=s.sent(),s.label=10;case 10:return[4,i.json()];case 11:return a=s.sent(),Vr(),(0,qn("heartbeat",24).store)(),this._setSubscriptionDomain(bn().hostname),[2,this._setChannel(a)]}}))}))},Object.defineProperty(n.prototype,"_intlDetails",{get:function(){return w(this.localeOverride)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"_remoteData",{get:function(){var t=this;if(!this._remoteDataProvider){var e=new wr({paths:o.paths.remote_data,sdkVersion:o.VERSION,appKey:o.appKey},X(o)),n=new R({ttlMs:o.remoteData.cacheTtlMs,prefix:o.storagePrefix},self.sessionStorage);this._remoteDataProvider=new Er(e,(function(){return Hr(t,void 0,void 0,(function(){var t;return Qr(this,(function(e){return[2,{country:(t=this._intlDetails).localeCountry,language:t.localeLanguage}]}))}))}),new B(n))}return this._remoteDataProvider},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"preferenceCenters",{get:function(){return this._preferenceCenterManager||(this._preferenceCenterManager=new Or(this._remoteData)),this._preferenceCenterManager},enumerable:!1,configurable:!0}),n.prototype._set=function(t){void 0===t&&(t={}),t.channel&&t.channel.channel_id&&this._setChannel(t.channel),t.tags&&this.channel&&this.channel.tags.sync(t.tags),t.subscriptionDomain&&this._setSubscriptionDomain(t.subscriptionDomain),t.session&&this._setSession(t.session)},n.prototype._setSubscriptionDomain=function(t){d.set("subscriptionDomain",t);var e=new CustomEvent("subscriptiondomain",{detail:t});this.dispatchEvent(e)},n.prototype._setChannel=function(t){var e=this;return this.channel?(this.channel.set(t),this.channel):(this.channel=new ye((function(){return e.contact}),t),this.localeOverride.setChannel(this.channel),this.channel.addEventListener("channel",(function(t){t.channel=t.detail,e.dispatchEvent(t)})),this.channel.tags.addEventListener("tags",(function(t){var n=new CustomEvent("tags",{detail:t.detail});n.tags=t.detail,e.dispatchEvent(n)})),this.channel)},n.prototype._setSession=function(t){et.setJSON("session",t),this._channelPromise.then((function(e){Hn(e,t)}))},Object.defineProperty(n.prototype,"isSetup",{get:function(){return this._isSetup.promise},enumerable:!1,configurable:!0}),n}(e.EventTarget),Yr=Zr,Xr=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},$r=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};function ti(t){return Xr(this,void 0,void 0,(function(){var e,n;return $r(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,t.registration.pushManager.getSubscription()];case 1:return e=r.sent(),n=e?t.location.hostname:null,[4,d.set("subscriptionDomain",n)];case 2:return r.sent(),[2,!0];case 3:return u("Error while storing subscription domain",r.sent()),[2,!1];case 4:return[2]}}))}))}var ei=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},ni=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},ri=function(){function t(t){var e;this._channelId=t.channelId,this._namedUserId=null!==(e=t.namedUserId)&&void 0!==e?e:null,this._optedIn=t.optedIn,this._localeOverride=t.localeOverride}return Object.defineProperty(t.prototype,"id",{get:function(){return this._channelId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"named_user_id",{get:function(){return console.warn("accessing the `named_user_id` of a channel may return a non-canonical response. its use is deprecated."),this._namedUserId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"optedIn",{get:function(){return this._optedIn},enumerable:!1,configurable:!0}),t.fromStorage=function(e,n){var r;return ei(this,void 0,void 0,(function(){var i,o;return ni(this,(function(a){switch(a.label){case 0:return[4,e.get("channel")];case 1:return(i=a.sent())?[4,n()]:[3,3];case 2:return o=a.sent(),[2,new t({channelId:i.channel_id,namedUserId:null!==(r=i.named_user_id)&&void 0!==r?r:void 0,optedIn:se(i.opt_in),localeOverride:o})];case 3:return[2]}}))}))},t.prototype.toJSON=function(){return Object.assign(P({optedIn:this.optedIn,localeOverride:this._localeOverride}),{channel_id:this.id,opt_in:this.optedIn})},t}(),ii=ri,oi=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},ai=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};function si(t){return oi(this,void 0,void 0,(function(){return ai(this,(function(e){try{return[2,ui(t)]}catch(t){u("Unable to migrate registration on service worker startup.","Proceeding with installation.",t)}return[2]}))}))}function ui(t,e){return oi(this,void 0,void 0,(function(){var n,r;return ai(this,(function(i){switch(i.label){case 0:return[4,fr(t)];case 1:return[4,ci(i.sent(),e)];case 2:return n=i.sent(),r=li,[4,n.json()];case 3:return[2,r.apply(void 0,[i.sent()])]}}))}))}function ci(t,e){var n=function(t,e){var n=e?{identity_hints:{accengage_device_id:e}}:{},r=ur(t,P({optedIn:!0}));return Object.assign(r,n)}(t,e);return U(o.paths.cra,{method:"post",body:n})}function li(t){var e,n=new ii({channelId:t.channel_id,namedUserId:null!==(e=t.named_user_id)&&void 0!==e?e:void 0,optedIn:se(t.opt_in)});return d.set("channel",n.toJSON())}var fi,pi=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},di=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};function hi(t,e){switch(e.data.command){case fi.AMP_SUBSCRIPTION_STATE:!function(t){var e,n,r;pi(this,void 0,void 0,(function(){var i,o,a,s;return di(this,(function(c){switch(c.label){case 0:return[4,t.registration.pushManager.getSubscription()];case 1:return i=c.sent(),[4,ii.fromStorage(d,(function(){return b.fromStorage()}))];case 2:return o=c.sent(),[4,null===(e=null===navigator||void 0===navigator?void 0:navigator.permissions)||void 0===e?void 0:e.query({name:"notifications"})];case 3:return a=null===(n=c.sent())||void 0===n?void 0:n.state,s=null!==i&&(null===(r=null==o?void 0:o.optedIn)||void 0===r||r)&&"granted"===a,u("AMP[onMessageReceivedSubscriptionState]",{channel:o,isSubscribed:s,permission:a}),vi(t,fi.AMP_SUBSCRIPTION_STATE,s),[2]}}))}))}(t);break;case fi.AMP_SUBSCRIBE:!function(t){u("AMP[onMessageReceivedSubscribe]"),si(t.registration).then((function(){return vi(t,fi.AMP_SUBSCRIBE,null)}))}(t);break;case fi.AMP_UNSUBSCRIBE:!function(t){ye.fromStorage((function(){throw new Error("contact not available in this context")})).then((function(t){return t&&t.optOut()})).then((function(){return vi(t,fi.AMP_UNSUBSCRIBE,null)}))}(t)}}function vi(t,e,n){t.clients.matchAll().then((function(t){for(var r=0;r<t.length;r++){t[r].postMessage({command:e,payload:n})}}))}!function(t){t.AMP_SUBSCRIPTION_STATE="amp-web-push-subscription-state",t.AMP_SUBSCRIBE="amp-web-push-subscribe",t.AMP_UNSUBSCRIBE="amp-web-push-unsubscribe"}(fi||(fi={}));var yi=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},bi=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};function gi(){return yi(this,void 0,void 0,(function(){var t;return bi(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,d.get("channel")];case 1:return[2,null==(t=e.sent())?void 0:t.channel_id];case 2:return u("Error fetching channel ID from indexedDB",e.sent()),[3,3];case 3:return[2]}}))}))}var mi=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},wi=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};function _i(t){return"object"==typeof t&&(!!t&&!Array.isArray(t))}function Si(t){return!!_i(t)&&("channel_id"in t&&"string"==typeof t.channel_id&&"string"==typeof t.send_id)}function Pi(t){return!!_i(t)&&("a4sid"in t&&"string"==typeof t.a4sid)}function xi(t){return gi().then((function(e){var n={channel_id:e,body:t.body,title:t.title,icon:t.icon,require_interaction:"reqInt"in t&&Boolean(t.reqInt)},r=function(t){var e,n;if(null==t?void 0:t.onClick){var r=new URL(t.onClick.url),i=r.searchParams;try{for(var o=mi(Object.entries(t.onClick.params||{})),a=o.next();!a.done;a=o.next()){var s=wi(a.value,2),u=s[0],c=s[1];i.set(u,c)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return r.search=i.toString(),r.toString()}}(t);return r&&(n.action={"^u":r}),t.a4sb&&Array.isArray(t.a4sb)&&t.a4sb.length&&(n.buttons=t.a4sb.reduce((function(t,e){var n={id:String(e.id),label:e.title,icon:e.icon,actions:{open:{type:"url",content:e.url}}};return t.push(n),t}),[])),"a4sbigpicture"in t&&(n.image=t.a4sbigpicture),n}))}function Ei(t){return"contact"===t.type}function Oi(t){return"channel"===t.type}var Mi=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},ki=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Ai=function(){function t(t,e){this._channel=t,this._contact=e}return t.prototype.handleActions=function(t){var e,n;return Mi(this,void 0,void 0,(function(){var r,i,o;return ki(this,(function(a){return r=null===(e=t.subscription_list)||void 0===e?void 0:e.filter(Ei),i=null===(n=t.subscription_list)||void 0===n?void 0:n.filter(Oi),o=[],(null==r?void 0:r.length)&&o.push(this._handleContactSubscriptions(r)),(null==i?void 0:i.length)&&o.push(this._handleChannelSubscriptions(i)),[2,Promise.all(o).then((function(t){return t.every(Boolean)}))]}))}))},t.prototype._handleContactSubscriptions=function(t){return Mi(this,void 0,void 0,(function(){var e,n;return ki(this,(function(r){switch(r.label){case 0:return[4,this._contact()];case 1:return[4,r.sent().subscriptions.edit()];case 2:e=r.sent(),t.forEach((function(t){"subscribe"===t.action?e.subscribe(t.list,t.scope):e.unsubscribe(t.list,t.scope)})),r.label=3;case 3:return r.trys.push([3,5,,6]),[4,e.apply()];case 4:return r.sent(),[2,!0];case 5:return n=r.sent(),console.error(n),[2,!1];case 6:return[2]}}))}))},t.prototype._handleChannelSubscriptions=function(t){return Mi(this,void 0,void 0,(function(){var e,n;return ki(this,(function(r){switch(r.label){case 0:return[4,this._channel()];case 1:return[4,r.sent().subscriptions.edit()];case 2:e=r.sent(),t.forEach((function(t){"subscribe"===t.action?e.subscribe(t.list):e.unsubscribe(t.list)})),r.label=3;case 3:return r.trys.push([3,5,,6]),[4,e.apply()];case 4:return r.sent(),[2,!0];case 5:return n=r.sent(),console.error(n),[2,!1];case 6:return[2]}}))}))},t}(),Ti=Ai,Ci=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Ii=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};function ji(t,e){var n,r;return Ci(this,void 0,void 0,(function(){var i,a,s,u,c,l,f;return Ii(this,(function(p){switch(p.label){case 0:return e.notification.close(),i=e.action,Si(a=e.notification.data)?(i?(s=null===(n=a.buttons)||void 0===n?void 0:n.find((function(t){return t.id===i})),u=null!==(r=null==s?void 0:s.actions)&&void 0!==r?r:{}):(h=a.action||{},v=h["^u"]||h["^d_a"]||h["^p_a"],(y={}).open=v?{type:"url",content:v}:{type:"home"},h["^+t"]&&(y.add_tag=h["^+t"]),h["^-t"]&&(y.remove_tag=h["^-t"]),h["^sl"]&&(y.subscription_list=h["^sl"]),u=y),c=a.channel_id,l=a.send_id,f=function(t){var e,n;return"home"===(null===(e=t.open)||void 0===e?void 0:e.type)?o.defaultActionURL:"url"===(null===(n=t.open)||void 0===n?void 0:n.type)?t.open.content:null}(u),f&&t.clients.openWindow?[4,t.clients.openWindow(f)]:[3,2]):[2,!1];case 1:p.sent(),p.label=2;case 2:return c?[4,Ni(c,u)]:[3,5];case 3:return p.sent(),[4,Ri(c,u)];case 4:p.sent(),p.label=5;case 5:return l&&c?[4,ii.fromStorage(d,(function(){return b.fromStorage()})).then((function(t){return t=null!=t?t:new ii({channelId:c,optedIn:!0}),i?function(t,e,n){return Jn(this,void 0,void 0,(function(){var r,i;return zn(this,(function(a){switch(a.label){case 0:return[4,Yn(t.optedIn)];case 1:return a.sent()?(r=o.paths.reports.customEvent,i={occurred:new Date(Date.now()).toISOString().split(".")[0],user:{web_channel:t.id},send_id:e,body:{name:"button--"+n.toLowerCase(),interaction_type:"ua_interactive_notification"}},[2,U(r,{method:"post",body:i})]):[2,!1]}}))}))}(t,l,i):function(t,e){return Jn(this,void 0,void 0,(function(){var n,r;return zn(this,(function(i){switch(i.label){case 0:return[4,Yn(t.optedIn)];case 1:return i.sent()?(n=o.paths.reports.direct,r={channel:t.toJSON(),send_id:e},[2,U(n,{method:"post",body:r})]):[2,!1]}}))}))}(t,l)}))]:[3,8];case 6:return p.sent(),[4,Bi(l)];case 7:p.sent(),p.label=8;case 8:return[2,!0]}var h,v,y}))}))}function Ni(t,e){return void 0===e&&(e={}),Ci(this,void 0,void 0,(function(){var n,r,i,a;return Ii(this,(function(s){switch(s.label){case 0:if(n=D(e.add_tag),r=D(e.remove_tag),!n&&!r)return[2,!0];i={audience:{channel:t}},n&&(i.add={device:n}),r&&(i.remove={device:r}),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,U(o.paths.tags,{method:"post",body:i})];case 2:return[2,s.sent().ok];case 3:return a=s.sent(),console.error(a),[2,!1];case 4:return[2]}}))}))}function Ri(t,e){return void 0===e&&(e={}),Ci(this,void 0,void 0,(function(){var n,r;return Ii(this,(function(i){return e.subscription_list&&e.subscription_list.length?(n=function(){return Ci(this,void 0,void 0,(function(){return Ii(this,(function(e){return[2,ye.fromStorage((function(){return r})).then((function(e){return null!=e?e:new ye((function(){return r}),{channel_id:t,opt_in:!0})}))]}))}))}(),r=function(){return Ci(this,void 0,void 0,(function(){return Ii(this,(function(t){return[2,Promise.resolve(yn(o,(function(){return n}),(function(){return b.fromStorage()}),{isDataCollectionEnabled:M},new Jr))]}))}))}(),[2,new Ti((function(){return n}),(function(){return r})).handleActions(e)]):[2,!0]}))}))}function Bi(t){return Ci(this,void 0,void 0,(function(){var e;return Ii(this,(function(n){switch(n.label){case 0:e=Date.now(),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,d.set("last_send_id",{id:t,timestamp:e})];case 2:return n.sent(),[2,!0];case 3:return n.sent(),[2,!1];case 4:return[2]}}))}))}var Li=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Ui=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Di=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};function Fi(t,e){var n;return Li(this,void 0,void 0,(function(){var r,i,a,s,u;return Ui(this,(function(c){switch(c.label){case 0:return[4,Pi(e)?xi(e):Promise.resolve(e)];case 1:return r=c.sent(),i=r.title||o.defaultTitle,a=r.require_interaction||!1,s=r.send_id,[4,ti(t)];case 2:return c.sent(),[4,Gi(t,r)];case 3:c.sent(),c.label=4;case 4:return c.trys.push([4,6,,7]),[4,qi(t,s)];case 5:return c.sent(),[3,7];case 6:return u=c.sent(),console.error("error clearing notifications",u),[3,7];case 7:return r.body?[4,t.registration.showNotification(i,{body:r.body,icon:r.icon||o.defaultIcon,image:r.image,data:r,actions:null===(n=r.buttons)||void 0===n?void 0:n.map((function(t){return{title:t.label,action:t.id,icon:t.icon}})),requireInteraction:a})]:[3,9];case 8:c.sent(),c.label=9;case 9:return[2]}}))}))}function qi(t,e){return Li(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c;return Ui(this,(function(l){switch(l.label){case 0:return[4,t.registration.getNotifications()];case 1:if(!(null==(n=l.sent())?void 0:n.length))return[2];r=Date.now()/1e3;try{for(i=Di(n),o=i.next();!o.done;o=i.next()){if(a=o.value,!Si(s=a.data))return[2];e&&s.send_id===e||s.expiry&&s.expiry<r&&a.close()}}catch(t){u={error:t}}finally{try{o&&!o.done&&(c=i.return)&&c.call(i)}finally{if(u)throw u.error}}return[2]}}))}))}function Gi(t,e){var n={type:"push",push:e};return t.clients.matchAll().then((function(t){t.forEach((function(t){return t.postMessage(n)}))}))}var Vi=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Ki=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};function Wi(t,e){var n=ur(t,P({optedIn:!0}));return U(o.paths.cra+"/"+e,{method:"put",body:n})}try{var Ji=document.getElementById("_uasdk"),zi=Ji.rel,Hi=window;Ji&&zi&&Hi[zi]?"function"==typeof Hi[zi]._async_setup?Hi[zi]._async_setup((function(t){void 0===t&&(t={});if(Fn(t),!Cr()){var e=new Error("Browser is not supported");if("Promise"in window)return Promise.reject(e);throw e}var n=new Yr;return n._setup().then((function(){return n}))})):"function"==typeof Hi[zi]._setup&&Hi[zi]._setup((function(t){void 0===t&&(t={});if(Fn(t),!Cr())throw new Error("Browser is not supported");var e=new Yr;return e._legacySetup(),e})):Ji&&"secureBridge"===Ji.getAttribute("rel")&&(window.uaSetup={secureBridge:function(t){if("https:"!==bn().protocol)throw new Error("The secure bridge must be run on an HTTPS domain that is shared with the push registration page.");Fn(t,!0);var e,n,r,i,o=function(t){if(Array.isArray(t)&&t.length){var e=new URL(bn().href).searchParams.get("__ua_secondary_origin");if(!e)throw new Error("Secondary origin not specified. Missing `__ua_secondary_origin` query parameter.");if(!t.includes(e)&&e!==bn().origin)throw new Error("Secondary origin not allowed. Got: "+e+". Allowed: "+JSON.stringify(t));return e}return"http://"+bn().host}(t.allowedDomains);window.addEventListener("storage",et.onStorage(l)),window.addEventListener("message",(e=er,n=o,i={},function(t){window.clearTimeout(r);var o=Xn(t,n);Object.assign(i,o),r=window.setTimeout((function(){e(i),i={}}),20)}));var a=d.get("subscriptionDomain"),s=d.get("channel"),c=et.getJSON("tags");return Promise.all([s,a]).then((function(t){var e=tr(t,2),n=e[0],r=e[1];if(r&&u("[secure-bridge] Subscription domain found in secure-bridge: %s",r),l({channel:n,tags:c,subscriptionDomain:r}),n)return Zn().then((function(t){t&&(et.setJSON("session",t),l({session:t}))}))}));function l(t){window.parent.postMessage($n(t),o)}}})}catch(t){t instanceof ReferenceError&&self&&(self.uaSetup={worker:function(t,e){void 0===e&&(e={}),Fn(e),t.addEventListener("message",(function(e){(function(t){var e=Object.values(fi);return t.data&&e.includes(t.data.command)})(e)&&hi(t,e)})),t.addEventListener("push",(function(e){e.waitUntil(function(t,e){var n;return Li(this,void 0,void 0,(function(){var r;return Ui(this,(function(i){return Si(r=(null===(n=e.data)||void 0===n?void 0:n.json())||{})||Pi(r)?[2,Fi(t,r)]:[2]}))}))}(t,e))})),t.addEventListener("notificationclick",(function(e){e.waitUntil(ji(t,e))})),t.addEventListener("activate",(function(e){return function(t,e){e.waitUntil(Promise.all([t.clients.claim(),ti(t)]))}(t,e)})),t.addEventListener("pushsubscriptionchange",(function(e){return function(t,e){return Vi(this,void 0,void 0,(function(){var e,n;return Ki(this,(function(r){switch(r.label){case 0:return r.trys.push([0,3,,4]),[4,fr(t.registration)];case 1:return e=r.sent(),[4,gi()];case 2:return(n=r.sent())?[2,Wi(e,n)]:[2];case 3:return u("Error in changeEventHandler: %s",r.sent()),[3,4];case 4:return[2]}}))}))}(t)}))}})}}()}();